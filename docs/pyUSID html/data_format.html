

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Model and File Format &mdash; pyUSID 0.0.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Guidelines for Contribution" href="contribution_guidelines.html" />
    <link rel="prev" title="11. Input / Output / Computing utilities" href="auto_examples/cookbooks/plot_io_utils.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyUSID
          

          
          </a>

          
            
            
              <div class="version">
                0.0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">pyUSID</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_guides.html">Tutorials on Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_organization.html">Package Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples &amp; Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Model and File Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nomenclature">Nomenclature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-model">Data model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-format">File format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-format">Data format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measurements">Measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dimensionality">Dimensionality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#why-should-you-care">Why should you care?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#proprietary-file-formats">Proprietary file formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#future-concerns">Future concerns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-problems">Other problems</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#universal-spectroscopy-and-imaging-data-usid-model">Universal Spectroscopy and Imaging Data (USID) Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#main-datasets"><code class="docutils literal notranslate"><span class="pre">Main</span></code> Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gray-scale-images">Gray-scale images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral-maps">Spectral maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#high-dimensional-data">High dimensional data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-measurements">Non Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complicated">Complicated?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compound-datasets">Compound Datasets:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ancillary-datasets"><code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gray-scale-image">Gray-scale image</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Spectral maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">High dimensional data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#channels">Channels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id5">File Format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#candidates">Candidates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#h5usid-usid-in-hdf5">h5USID - USID in HDF5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-basics-of-hdf5">Quick basics of HDF5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#main-data"><code class="docutils literal notranslate"><span class="pre">Main</span></code> data:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ancillary-data"><code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> data:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attributes">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groups">Groups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#measurement-data">Measurement data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tool-analysis-processing">Tool (analysis / processing)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-topics">Advanced topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#region-references"><code class="docutils literal notranslate"><span class="pre">Region</span> <span class="pre">references</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#processing-on-multiple-main-datasets">Processing on multiple <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sparse-sampling-compressed-sensing">Sparse Sampling / Compressed Sensing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribution_guidelines.html">Guidelines for Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What’s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_to_python.html">Upgrading from Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyUSID</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Data Model and File Format</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/data_format.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-model-and-file-format">
<h1><a class="toc-backref" href="#id6">Data Model and File Format</a><a class="headerlink" href="#data-model-and-file-format" title="Permalink to this headline">¶</a></h1>
<p><strong>Suhas Somnath</strong></p>
<p>8/8/2017</p>
<p>In this document we aim to provide a comprehensive overview of the motivation for and specifications of the
<strong>Universal Spectroscopy and Imaging Data</strong> (<strong>USID</strong>) Model and the file format (<strong>h5USID</strong>) used for storing
spectroscopy and imaging data.</p>
<p>Pycroscopy uses the <strong>USID</strong> model and <strong>h5USID</strong> files.</p>
<p><strong>Dr. Stephen Jesse</strong> conceived the <strong>USID</strong> while <strong>Dr. Suhas Somnath</strong> and <strong>Chris R. Smith</strong> implemented <strong>USID</strong>
into hierarchical data format (<strong>HDF5</strong>) files using python in <strong>pyUSID</strong></p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#data-model-and-file-format" id="id6">Data Model and File Format</a><ul>
<li><a class="reference internal" href="#nomenclature" id="id7">Nomenclature</a><ul>
<li><a class="reference internal" href="#data-model" id="id8">Data model</a></li>
<li><a class="reference internal" href="#file-format" id="id9">File format</a></li>
<li><a class="reference internal" href="#data-format" id="id10">Data format</a></li>
<li><a class="reference internal" href="#measurements" id="id11">Measurements</a></li>
<li><a class="reference internal" href="#dimensionality" id="id12">Dimensionality</a></li>
</ul>
</li>
<li><a class="reference internal" href="#why-should-you-care" id="id13">Why should you care?</a><ul>
<li><a class="reference internal" href="#proprietary-file-formats" id="id14">Proprietary file formats</a></li>
<li><a class="reference internal" href="#future-concerns" id="id15">Future concerns</a></li>
<li><a class="reference internal" href="#other-problems" id="id16">Other problems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#universal-spectroscopy-and-imaging-data-usid-model" id="id17">Universal Spectroscopy and Imaging Data (USID) Model</a><ul>
<li><a class="reference internal" href="#main-datasets" id="id18"><code class="docutils literal notranslate"><span class="pre">Main</span></code> Datasets</a><ul>
<li><a class="reference internal" href="#spectrum" id="id19">Spectrum</a></li>
<li><a class="reference internal" href="#gray-scale-images" id="id20">Gray-scale images</a></li>
<li><a class="reference internal" href="#spectral-maps" id="id21">Spectral maps</a></li>
<li><a class="reference internal" href="#high-dimensional-data" id="id22">High dimensional data</a></li>
<li><a class="reference internal" href="#non-measurements" id="id23">Non Measurements</a></li>
<li><a class="reference internal" href="#complicated" id="id24">Complicated?</a></li>
<li><a class="reference internal" href="#compound-datasets" id="id25">Compound Datasets:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ancillary-datasets" id="id26"><code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> Datasets</a><ul>
<li><a class="reference internal" href="#id2" id="id27">Spectrum</a></li>
<li><a class="reference internal" href="#gray-scale-image" id="id28">Gray-scale image</a></li>
<li><a class="reference internal" href="#id3" id="id29">Spectral maps</a></li>
<li><a class="reference internal" href="#id4" id="id30">High dimensional data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#channels" id="id31">Channels</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5" id="id32">File Format</a><ul>
<li><a class="reference internal" href="#requirements" id="id33">Requirements</a></li>
<li><a class="reference internal" href="#candidates" id="id34">Candidates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#h5usid-usid-in-hdf5" id="id35">h5USID - USID in HDF5</a><ul>
<li><a class="reference internal" href="#quick-basics-of-hdf5" id="id36">Quick basics of HDF5</a></li>
<li><a class="reference internal" href="#main-data" id="id37"><code class="docutils literal notranslate"><span class="pre">Main</span></code> data:</a></li>
<li><a class="reference internal" href="#ancillary-data" id="id38"><code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> data:</a></li>
<li><a class="reference internal" href="#attributes" id="id39">Attributes</a></li>
<li><a class="reference internal" href="#groups" id="id40">Groups</a><ul>
<li><a class="reference internal" href="#measurement-data" id="id41">Measurement data</a></li>
<li><a class="reference internal" href="#tool-analysis-processing" id="id42">Tool (analysis / processing)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-topics" id="id43">Advanced topics</a><ul>
<li><a class="reference internal" href="#region-references" id="id44"><code class="docutils literal notranslate"><span class="pre">Region</span> <span class="pre">references</span></code></a></li>
<li><a class="reference internal" href="#processing-on-multiple-main-datasets" id="id45">Processing on multiple <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets</a></li>
<li><a class="reference internal" href="#sparse-sampling-compressed-sensing" id="id46">Sparse Sampling / Compressed Sensing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="nomenclature">
<h2><a class="toc-backref" href="#id7">Nomenclature</a><a class="headerlink" href="#nomenclature" title="Permalink to this headline">¶</a></h2>
<p>Before we start off, lets clarify some nomenclature to avoid confusion.</p>
<div class="section" id="data-model">
<h3><a class="toc-backref" href="#id8">Data model</a><a class="headerlink" href="#data-model" title="Permalink to this headline">¶</a></h3>
<p>Data model refers to the way the data is arranged. This does <strong>not</strong> depend on the implementation in a particular file format</p>
</div>
<div class="section" id="file-format">
<h3><a class="toc-backref" href="#id9">File format</a><a class="headerlink" href="#file-format" title="Permalink to this headline">¶</a></h3>
<p>This corresponds to the kind of file, such as a spreadsheet (.CSV), an image (.PNG), a text file (.TXT) within which information is contained.</p>
</div>
<div class="section" id="data-format">
<h3><a class="toc-backref" href="#id10">Data format</a><a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Data_format">data format</a> is actually a rather broad term. However, we have observed that
people often refer to the combination of a data model implemented within a file format as a <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">format</span></code>.</p>
</div>
<div class="section" id="measurements">
<h3><a class="toc-backref" href="#id11">Measurements</a><a class="headerlink" href="#measurements" title="Permalink to this headline">¶</a></h3>
<p>In all measurements, some <code class="docutils literal notranslate"><span class="pre">quantity</span></code> such as voltage, resistance, current, amplitude, or intensity is collected
as a function of (typically all combinations of) one or more <code class="docutils literal notranslate"><span class="pre">independent</span> <span class="pre">variables</span></code>. For example, a gray-scale image represents the
quantity - intensity being recorded for all combinations of the variables - row and column. A (simple) spectrum represents
a quantity such as amplitude or phase recorded as a function of a reference variable such as wavelength or frequency.</p>
<p>Data collected from measurements result in N-dimensional datasets where each <code class="docutils literal notranslate"><span class="pre">dimension</span></code> corresponds to a variable that
was varied. Going back to the above examples a gray-scale image would be represented by a 2 dimensional dataset whose
dimensions are row and column. Similarly, a simple spectrum wold be a 1 dimensional dataset whose sole dimension would
be frequency for example.</p>
</div>
<div class="section" id="dimensionality">
<h3><a class="toc-backref" href="#id12">Dimensionality</a><a class="headerlink" href="#dimensionality" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>We consider data recorded for all combinations of 2 or more variables as <code class="docutils literal notranslate"><span class="pre">multi-dimensional</span></code> datasets or <code class="docutils literal notranslate"><span class="pre">Nth</span> <span class="pre">order</span> <span class="pre">tensors</span></code>:<ul>
<li>For example, if a single value of current is recorded as a function of driving / excitation bias or voltage having B values, the dataset is said to be <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">dimensional</span></code> and the dimension would be - <code class="docutils literal notranslate"><span class="pre">Bias</span></code>.</li>
<li>If the bias is cycled C times, the data is said to be <code class="docutils literal notranslate"><span class="pre">two</span> <span class="pre">dimensional</span></code> with dimensions - <code class="docutils literal notranslate"><span class="pre">(Bias,</span> <span class="pre">Cycle)</span></code>.</li>
<li>If the bias is varied over B values over C cycles at X columns and Y rows in a 2D grid of positions, the resultant dataset would have <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">dimensions:</span></code> <code class="docutils literal notranslate"><span class="pre">(Rows,</span> <span class="pre">Columns,</span> <span class="pre">Cycle,</span> <span class="pre">Bias)</span></code>.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">Multi-feature</span></code>: As a different example, let us suppose that the <code class="docutils literal notranslate"><span class="pre">petal</span> <span class="pre">width</span></code>, <code class="docutils literal notranslate"><span class="pre">length</span></code>, and <code class="docutils literal notranslate"><span class="pre">weight</span></code> were measured for <code class="docutils literal notranslate"><span class="pre">F</span></code> different kinds of flowers. This would result in a <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">dimensional</span> <span class="pre">dataset</span></code> with the kind of flower being the sole dimension. Such a dataset is <strong>not</strong> a 3 dimensional dataset because the <code class="docutils literal notranslate"><span class="pre">petal</span> <span class="pre">width,</span> <span class="pre">length</span></code>, and <code class="docutils literal notranslate"><span class="pre">weight</span></code> are only different <code class="docutils literal notranslate"><span class="pre">features</span></code> for each measurement. Some quantity needs to be <strong>measured for all combinations of</strong> petal width, length, and weight to make this dataset 3 dimensional. Most examples observed in data mining, simple machine learning actually fall into this category</li>
</ul>
</div>
</div>
<div class="section" id="why-should-you-care">
<h2><a class="toc-backref" href="#id13">Why should you care?</a><a class="headerlink" href="#why-should-you-care" title="Permalink to this headline">¶</a></h2>
<p>The quest for understanding more about matter has necessitated the
development of a multitude of instruments, each capable of numerous
measurement modalities.</p>
<div class="section" id="proprietary-file-formats">
<h3><a class="toc-backref" href="#id14">Proprietary file formats</a><a class="headerlink" href="#proprietary-file-formats" title="Permalink to this headline">¶</a></h3>
<p>Typically, each commercial instruments generates data files formatted in
proprietary file formats by the instrument manufacturer. The proprietary
nature of these file formats and the obfuscated data model within the files impede scientific progress in the
following ways:</p>
<ol class="arabic simple">
<li>By making it challenging for researchers to extract data from these files</li>
<li>Impeding the correlation of data acquired from different instruments.</li>
<li>Inability to store results back into the same file</li>
<li>Inflexibility to accommodate few kilobytes to several gigabytes of data</li>
<li>Requiring different versions of analysis routines for each data format</li>
<li>In some cases, requiring proprietary software provided with the instrument to access the data</li>
</ol>
</div>
<div class="section" id="future-concerns">
<h3><a class="toc-backref" href="#id15">Future concerns</a><a class="headerlink" href="#future-concerns" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Several fields are moving towards the open science paradigm which will require journals and researchers to support
journal papers with data and analysis software</li>
<li>US Federal agencies that support scientific research require curation of datasets in a clear and organized manner</li>
</ol>
</div>
<div class="section" id="other-problems">
<h3><a class="toc-backref" href="#id16">Other problems</a><a class="headerlink" href="#other-problems" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>The vast majority of scientific software packages (e.g. X-array) aim to focus at information already available in
memory. In other words they do not solve the problem of storing data in a self-describing manner and reading +
processing this data.</li>
<li>There are a few file formatting packages and approaches (Nexus, NetCDF). However, they are typically narrow in scope
and only solve the data formatting for specific communities</li>
<li>Commercial image analysis software are often woefully limited in their capabilities and only work on simple 1, 2, and
in some cases- 3D datasets. There are barely any software for handling arbitrarily large multi-dimensional datasets.</li>
<li>In many cases, especially electron and ion based microscopy, the very act of probing the sample damages the sample.
To minimize damage to the sample, researchers only sample data from a few random positions in the 2D grid and use
advanced algorithms to reconstruct the missing data. We have not come across any robust solutions for storing such
<strong>Compressed sensing / sparse sampling</strong> data. More in the <strong>Advanced Topics</strong> section.</li>
</ol>
</div>
</div>
<div class="section" id="universal-spectroscopy-and-imaging-data-usid-model">
<h2><a class="toc-backref" href="#id17">Universal Spectroscopy and Imaging Data (USID) Model</a><a class="headerlink" href="#universal-spectroscopy-and-imaging-data-usid-model" title="Permalink to this headline">¶</a></h2>
<p>To solve the above and many more problems, we have developed an
<strong>instrument agnostic data model</strong> that can be used to represent data
from any instrument, size, dimensionality, or complexity.</p>
<p>Information in <strong>USID</strong> are stored in three main kinds of datasets:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets that contain the raw measurements recorded from
the instrument as well as results from processing or analysis routines
applied to the data</li>
<li>Mandatory <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets that are necessary to explain the
<code class="docutils literal notranslate"><span class="pre">main</span></code> data</li>
<li><code class="docutils literal notranslate"><span class="pre">Extra</span></code> datasets store any other data that may be of value</li>
</ol>
<p>In addition to datasets, the data model is highly reliant on metadata that capture
smaller pieces but critical pieces of information such as the
<code class="docutils literal notranslate"><span class="pre">quantity</span></code> and <code class="docutils literal notranslate"><span class="pre">units</span></code> that describe every data point in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset.</p>
<p><strong>We acknowledge that this data model is not trivial to understand at first glance but we are making every effort
to make is simple to understand. If you ever find anything complicated or unclear, please</strong> <a class="reference external" href="./contact.html">write to us</a>
<strong>and we will improve our documentation.</strong></p>
<div class="section" id="main-datasets">
<h3><a class="toc-backref" href="#id18"><code class="docutils literal notranslate"><span class="pre">Main</span></code> Datasets</a><a class="headerlink" href="#main-datasets" title="Permalink to this headline">¶</a></h3>
<p>Regardless of origin, modality or complexity, imaging data (and most scientific data for that matter) have one
thing in common:</p>
<p><strong>The same measurement / operation is performed at each spatial position</strong></p>
<p>The <strong>USID</strong> model is based on this one simple ground-truth.
The data always has some <code class="docutils literal notranslate"><span class="pre">spatial</span> <span class="pre">dimensions</span></code> (X, Y, Z) and some
<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> (time, frequency, intensity, wavelength,
temperature, cycle, voltage, etc.). <strong>In USID, the spatial
dimensions are collapsed onto a single dimension and the spectroscopic
dimensions are flattened into the second dimension.</strong> Thus, all data are
stored as <strong>two dimensional arrays</strong>. The data would be arranged in the same manner that
reflects the sequence in which the individual data points were collected. Examples below
will simplify this data-representation paradigm significantly.</p>
<p>In general, if a measurement of length <code class="docutils literal notranslate"><span class="pre">P</span></code> was recorded for each of <code class="docutils literal notranslate"><span class="pre">N</span></code> positions,
it would be structured as shown in the table below here the prefixes <code class="docutils literal notranslate"><span class="pre">i</span></code> correspond to
the positions and <code class="docutils literal notranslate"><span class="pre">j</span></code> for spectroscopic:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="11%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>i0, j0</td>
<td>i0, j1</td>
<td>i0, j2</td>
<td>&lt;..&gt;</td>
<td>i0, jP-2</td>
<td>i0, jP-1</td>
</tr>
<tr class="row-even"><td>i1, j0</td>
<td>i1, j1</td>
<td>i1, j2</td>
<td>&lt;..&gt;</td>
<td>i1, jP-2</td>
<td>i1, jP-1</td>
</tr>
<tr class="row-odd"><td>&lt;……&gt;</td>
<td>&lt;……&gt;</td>
<td>&lt;……&gt;</td>
<td>&lt;..&gt;</td>
<td>&lt;……..&gt;</td>
<td>&lt;……..&gt;</td>
</tr>
<tr class="row-even"><td>iN-2, j0</td>
<td>iN-2, j1</td>
<td>iN-2, j2</td>
<td>&lt;..&gt;</td>
<td>iN-2, jP-2</td>
<td>iN-2, jP-1</td>
</tr>
<tr class="row-odd"><td>iN-1, j0</td>
<td>iN-1, j1</td>
<td>iN-1, j2</td>
<td>&lt;..&gt;</td>
<td>iN-1, jP-1</td>
<td>iN-1, jP-1</td>
</tr>
</tbody>
</table>
<p>A notion of chronology is attached to both the position and spectroscopic axes.
In other words, the data for the second location (second row in the above table)
was acquired before the first location (first row). The same applies to the spectroscopic axis as well.
This is an important point to remember especially when information is recorded
from multiple sources or channels (e.g. - data from different sensors) or if two or more numbers are <strong>necessary</strong> to
give a particular observation / data point its correct meaning (e.g. - color images).
This point will be clarified via examples that follow.</p>
<p>While the data could indeed be stored in the original N-dimensional form,
there are a few key <strong>advantages to the 2D structuring</strong>:</p>
<ul class="simple">
<li>The data is already of the <strong>same structure expected by machine learning algorithms</strong> and requires minimal
to no pre-processing or post-processing. Briefly, the data is simply arranged in the standard form of <code class="docutils literal notranslate"><span class="pre">instances</span> <span class="pre">x</span> <span class="pre">features</span></code>,
where <code class="docutils literal notranslate"><span class="pre">instances</span></code> makes up the locations and <code class="docutils literal notranslate"><span class="pre">features</span></code> which contains all the observables per entry.</li>
<li>In certain cases, the data simply <strong>cannot be represented in an N-dimensional form</strong> since one of the dimensions
has multiple sizes in different contexts.</li>
<li>Researchers want to acquire ever larger datasets that
take much longer to acquire. This has necessitated approaches such as
<strong>sparse sampling</strong> or <a class="reference external" href="https://en.wikipedia.org/wiki/Compressed_sensing">compressed sensing</a> wherein
measurements are acquired from a few randomly sampled positions and the
data for the rest of the positions are inferred using complex
algorithms. Storing such sparse sampled data in the N dimensional form
would balloon the size of the stored data even though the majority of the
data is actually empty. Two dimensional datasets would allow the random
measurements to be written without any empty sections.</li>
<li>When acquiring measurement data, users often adjust experimental parameters
during the experiment that may affect the size of the data, especially the
spectral sizes. Thus, <strong>changes in experimental parameters</strong> would mean that the
existing N dimensional set would have to be left partially (in most cases
largely) empty and a new N dimensional dataset would have to be allocated
with the first few positions left empty. In the case of flattened datasets,
the current dataset can be truncated at the point of the parameter change
and a new dataset can be created to start from the current measurement.
Thus, no space would be wasted.</li>
</ul>
<p>Here are some examples of how some familiar data can be represented using
this paradigm:</p>
<div class="section" id="spectrum">
<h4><a class="toc-backref" href="#id19">Spectrum</a><a class="headerlink" href="#spectrum" title="Permalink to this headline">¶</a></h4>
<img alt="_images/1D_spectra.svg" src="_images/1D_spectra.svg" /><p>This case encompasses examples such as a <strong>single</strong> Raman spectrum, force-distance curve in
atomic force microscopy, current-voltage spectroscopy, etc. In this case, the measurement is recorded
at a single location meaning that this dataset has a single <em>arbitrary</em> <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimension</span></code>
of size 1. At this position, data is recorded as a
function of a single variable (<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code>) such as <em>wavelength</em> or <em>frequency</em>.
Thus, if the spectrum contained <code class="docutils literal notranslate"><span class="pre">S</span></code> data points, the <strong>USID</strong> representation of this
data would be a <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">S</span></code> matrix. The <code class="docutils literal notranslate"><span class="pre">quantity</span></code> represented in this data would be <strong>Amplitude</strong>.</p>
</div>
<div class="section" id="gray-scale-images">
<h4><a class="toc-backref" href="#id20">Gray-scale images</a><a class="headerlink" href="#gray-scale-images" title="Permalink to this headline">¶</a></h4>
<img alt="_images/2D_images.svg" src="_images/2D_images.svg" /><p>In such data, a single value (<code class="docutils literal notranslate"><span class="pre">quantity</span></code> is <em>intensity</em>) in is recorded
at each location in a two dimensional grid. Thus, there are are two
<code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code> - <em>X</em>, <em>Y</em>. The value at each pixel was not really acquired
as a function of any variable so the data has one <em>arbitrary</em> <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code>.
Thus, if the image had <code class="docutils literal notranslate"><span class="pre">P</span></code> rows and <code class="docutils literal notranslate"><span class="pre">Q</span></code> columns, it would have to be flattened and
represented as a <code class="docutils literal notranslate"><span class="pre">P*Q</span> <span class="pre">x</span> <span class="pre">1</span></code> array according to the <strong>USID</strong> model. The second
axis has size of 1 since we only record one value (intensity) at each
location. In theory, the flattened data could be arranged column-by-column (as in the figure above)
and then row-by-row or vice-versa depending on how the data was (sequentially)
captured. The sequence in this particular case is debatable in this particular example.</p>
<p>Popular examples of such data include imaging data from raster scans (e.g. - height channel in atomic force microscopy),
black-and-white photographs, scanning electron microscopy (SEM) images. etc.</p>
<p>Color images will be discussed separately below due to some very important subtleties about the
measurement.</p>
</div>
<div class="section" id="spectral-maps">
<h4><a class="toc-backref" href="#id21">Spectral maps</a><a class="headerlink" href="#spectral-maps" title="Permalink to this headline">¶</a></h4>
<img alt="_images/3D_map_of_spectra.svg" src="_images/3D_map_of_spectra.svg" /><p>If a spectrum of length <code class="docutils literal notranslate"><span class="pre">S</span></code> were acquired at each location in a two dimensional grid of positions
with <code class="docutils literal notranslate"><span class="pre">P</span></code> rows and <code class="docutils literal notranslate"><span class="pre">Q</span></code> columns, it would result in a three dimensional dataset.
This example is a combination of the two examples above. The above 3D dataset has two
<code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code> - <em>X</em> and <em>Y</em>, and has one <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code> - <em>Frequency</em>.
Each data point in the dataset contains the same physical <code class="docutils literal notranslate"><span class="pre">quantity</span></code> - <em>Amplitude</em>.
In order to represent this 3D dataset in the 2D <strong>USID</strong> form, the two <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code>
in such data would need to be flattened along the vertical axis and the spectrum at each position
would be laid out along the horizontal axis or the spectroscopic axis.
Thus the original <code class="docutils literal notranslate"><span class="pre">P</span> <span class="pre">x</span> <span class="pre">Q</span> <span class="pre">x</span> <span class="pre">S</span></code> 3D array would be flattened to a 2D array of shape - <code class="docutils literal notranslate"><span class="pre">P*Q</span> <span class="pre">x</span> <span class="pre">S</span></code>.
Assuming that the data was acquired column-by-column and then row-by-row, the rows in the flattened
2D dataset would also be laid out in the same manner: row<sub>0</sub>col<sub>0</sub>, row<sub>0</sub>col<sub>1</sub>, row<sub>0</sub>col<sub>2</sub>,
… , row<sub>0</sub>col<sub>Q</sub>, row<sub>1</sub>col<sub>0</sub>, row<sub>1</sub>col<sub>1</sub>, …</p>
<p>Popular examples of such datasets include Scanning Tunnelling Spectroscopy (STS) and
current-voltage spectroscopy</p>
</div>
<div class="section" id="high-dimensional-data">
<h4><a class="toc-backref" href="#id22">High dimensional data</a><a class="headerlink" href="#high-dimensional-data" title="Permalink to this headline">¶</a></h4>
<p>This general representation for data was developed to express datasets with 7, 8, 9, or higher dimensional datasets.</p>
<p>The <strong>spectral map</strong> example above only had one <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code>. If spectra of length <code class="docutils literal notranslate"><span class="pre">S</span></code> were
acquired for <code class="docutils literal notranslate"><span class="pre">T</span></code> different <em>Temperatures</em>, the resultant dataset would have two <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> -
<em>Frequency</em> and <em>Temperature</em> and would be of shape - <code class="docutils literal notranslate"><span class="pre">P</span> <span class="pre">x</span> <span class="pre">Q</span> <span class="pre">x</span> <span class="pre">T</span> <span class="pre">x</span> <span class="pre">S</span></code>. Just as the two <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code>
were flattened along the vertical axis in the example above, now the two spectroscopic dimensions would also need
to be flattened along the horizontal axis. Thus the horizontal axis would be flattend as:
Temperature<sub>0</sub>Frequency<sub>0</sub>, Temperature<sub>0</sub>Frequency<sub>1</sub>,Temperature<sub>0</sub>Frequency<sub>2</sub>, …
, Temperature<sub>0</sub>Frequency<sub>S</sub>, Temperature<sub>1</sub>Frequency<sub>0</sub>, Temperature<sub>1</sub>Frequency<sub>1</sub>, …
This four dimensional dataset would be flattened into a two dimensional array of shape <code class="docutils literal notranslate"><span class="pre">P*Q</span> <span class="pre">x</span> <span class="pre">T*S</span></code>.</p>
<p>In the same manner, one could keep adding additional dimensions to either the position or spectroscopic axis.</p>
</div>
<div class="section" id="non-measurements">
<h4><a class="toc-backref" href="#id23">Non Measurements</a><a class="headerlink" href="#non-measurements" title="Permalink to this headline">¶</a></h4>
<p>This same flattened representation can also be applied to results of data analyses or
data that were not directly recorded from an instrument. Here are some examples:</p>
<ul class="simple">
<li>A collection of <code class="docutils literal notranslate"><span class="pre">k</span></code> chosen spectra would also be considered
<code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets since the data is still structured as
<code class="docutils literal notranslate"><span class="pre">[instance,</span> <span class="pre">features]</span></code></li>
<li>Similarly, the centroids obtained from a clustering algorithm like
<code class="docutils literal notranslate"><span class="pre">k-Means</span> <span class="pre">clustering</span></code></li>
<li>The abundance maps obtained from decomposition algorithms like
<code class="docutils literal notranslate"><span class="pre">Singular</span> <span class="pre">Value</span> <span class="pre">Decomposition</span> <span class="pre">(SVD)</span></code> or
<code class="docutils literal notranslate"><span class="pre">Non-negative</span> <span class="pre">matrix</span> <span class="pre">factorization</span> <span class="pre">(NMF)</span></code></li>
</ul>
</div>
<div class="section" id="complicated">
<h4><a class="toc-backref" href="#id24">Complicated?</a><a class="headerlink" href="#complicated" title="Permalink to this headline">¶</a></h4>
<p>This data model may seem unnecessarily complicated for very simple / rigid data such as 2D images or 1D spectra.
However, bear in mind that <strong>this paradigm was designed to represent any information regardless of dimensionality, origin, complexity</strong>, etc.
Thus, encoding data in this manner will allow seamless sharing, exchange, and interpretation of data.</p>
</div>
<div class="section" id="compound-datasets">
<h4><a class="toc-backref" href="#id25">Compound Datasets:</a><a class="headerlink" href="#compound-datasets" title="Permalink to this headline">¶</a></h4>
<p>There are instances where multiple values are associate with a
single position and spectroscopic value in a dataset.  In these cases,
we use the <a class="reference external" href="https://support.hdfgroup.org/HDF5/Tutor/compound.html">compound dataset functionality in HDF5</a>
to store all of the
values at each point.  This also allows us to access any combination of
the values without needing to read all of them.  Pycroscopy actually uses
compound datasets a lot more frequently than one would think. The need
and utility of compound datasets are best described with examples:</p>
<ul>
<li><p class="first"><strong>Color images</strong>: Each position in these datasets contain three (red,
blue, green) or four (cyan, black, magenta, yellow) values. One would
naturally be tempted to simply treat these datasets as <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">4</span></code>
datasets, (where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the product of the number of <em>rows</em> and <em>columns</em>
as in the gray-scale image example above) and it certainly is not wrong
to represent data this way. However,
storing the data in this manner would mean that the <em>red</em> intensity was
collected first, followed by the <em>green</em>, and finally by the <em>blue</em>. In
other words, <strong>a notion of chronology is attached to both the position
and spectroscopic axes</strong> according to the <strong>USID</strong> definition.
While the intensities for each color may be acquired sequentially in
detectors, since we are not aware of the exact sequence we will assume
that the <em>red</em>, <em>green</em>, and <em>blue</em> values are acquired simultaneously for
simultaneously.</p>
<p>In these cases, we store data using <code class="docutils literal notranslate"><span class="pre">compound</span> <span class="pre">datasets</span></code>
that allow the storage of multiple pieces of data within the same <code class="docutils literal notranslate"><span class="pre">cell</span></code>.
While this may seem confusing or implausible, remember that computers
store complex numbers in the same way. The complex numbers have a <em>real</em>
and an <em>imaginary</em> component just like color images have <em>red</em>, <em>blue</em>,
and <em>green</em> components that describe a single pixel. Therefore, color
images in the <strong>USID</strong> representation would be represented by a <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">1</span></code> matrix with
compound values instead of a <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">3</span></code> matrix with real or integer values.
For example, one would refer to the <em>red</em> component at a particular position as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">red_value</span> <span class="o">=</span> <span class="n">dataset_name</span><span class="p">[</span><span class="n">position_index</span><span class="p">,</span> <span class="n">spectroscopic_index</span><span class="p">][</span><span class="s1">&#39;red&#39;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Functional fits</strong>: Let’s take the example of a dataset flattened to shape - <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">P</span></code>,
whose spectra at each location are fitted to a complicated equation. Now, the <code class="docutils literal notranslate"><span class="pre">P</span></code>
points in the spectra will be represented by <code class="docutils literal notranslate"><span class="pre">S</span></code> coefficients that don’t
necessarily follow any order. Consequently, the result of the functional
fit should actually be a <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">1</span></code> dataset where each element is a compound
value made up of the <code class="docutils literal notranslate"><span class="pre">S</span></code> coefficients. Note that while some form of sequence
can be forced onto the coefficients if the spectra were fit to polynomial
functions, the drawbacks outweigh the benefits:</p>
<ul class="simple">
<li><strong>Slicing</strong>: Storing data in compound datasets circumvents problems associated
with getting a specific / the <code class="docutils literal notranslate"><span class="pre">kth</span></code> coefficient if the data were stored in a
real-valued matrix instead.</li>
<li><strong>Visualization</strong> also becomes a lot simpler since compound datasets cannot
be plotted without specifying the component / coefficient of interest. This
avoids plots with alternating coefficients that are several orders of
magnitude larger / smaller than each other.</li>
</ul>
</li>
</ul>
<p>While one could represent multiple channels of information simultaneously acquired by instruments
(for example - height, amplitude, phase channels in atomic force microscopy scan images) using compound datasets,
this is <strong>not</strong> the intended purpose of compound datasets. We use recommend storing each
channel of information separately for consistency across scientific disciplines.
For example, there are modalities in microscopy where some channels provide high
resolution topography data while others provide low-resolution but spectroscopy data.</p>
<p>For more information on compound datasets see the
<a class="reference external" href="http://docs.h5py.org/en/latest/high/dataset.html#reading-writing-data">h5py Datasets documentation</a>
from the HDF Group.</p>
</div>
</div>
<div class="section" id="ancillary-datasets">
<h3><a class="toc-backref" href="#id26"><code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> Datasets</a><a class="headerlink" href="#ancillary-datasets" title="Permalink to this headline">¶</a></h3>
<p>So far we have explained how the (<code class="docutils literal notranslate"><span class="pre">main</span></code>) dataset of interest can be flattened and represented
regardless of its origin, size, dimensionality, etc. In order to make this
<code class="docutils literal notranslate"><span class="pre">main</span></code> dataset <strong>self-explanatory</strong>, additional pieces of information are required.
For example, while the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset preserves the data of interest, information regarding the
original dimensionality of the data or the combination of parameters corresponding to each
observation is not captured.</p>
<p>In order to capture such vital information, each <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset is always accompanied by
<strong>four</strong> <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets. These are the:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> and <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code> that describe the index and
value of any given row or spatial position in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code> and <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code> that describe the
index and values all columns in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset for all spectroscopic dimensions.</li>
</ul>
<p>The pair of <code class="docutils literal notranslate"><span class="pre">Values</span></code> datasets are analogous to legends for maps. In other words, the pair of
<code class="docutils literal notranslate"><span class="pre">Values</span></code> datasets <strong>provide the combination of the values for each dimension</strong> / variable
that correspond to a particular data point in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset. For example, one
would be able to understand readily that a particular data point in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset
was acquired for the reference values of <em>Frequency</em> of 315 kHz, <em>Temperature</em> of 400 K
from the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code> dataset and location <em>X</em> of 7.125 microns and <em>Y</em> of
480 nanometers from the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> dataset.</p>
<p>The pair of <code class="docutils literal notranslate"><span class="pre">Indices</span></code> datasets are essentially <strong>counters for each position
and spectroscopic dimension</strong> / variable. Continuing the example presented for the <code class="docutils literal notranslate"><span class="pre">Values</span></code>
datasets, let’s assume that the data was acquired as a function of all unique combinations of
<code class="docutils literal notranslate"><span class="pre">37</span></code> <em>Frequency</em> values, <code class="docutils literal notranslate"><span class="pre">12</span></code> <em>Temperatures</em>, <code class="docutils literal notranslate"><span class="pre">64</span></code> locations in the <em>X</em> direction
and <code class="docutils literal notranslate"><span class="pre">128</span></code> values in the <em>Y</em> direction. Then, the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code> dataset would
instruct that the given data point in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset corresponds to the <code class="docutils literal notranslate"><span class="pre">13th</span></code>
<em>Frequency</em> value and <code class="docutils literal notranslate"><span class="pre">5th</span></code> <em>Temperature</em> value. In the same way, the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code>
dataset would show that the data point of interest corresponds to the <code class="docutils literal notranslate"><span class="pre">47th</span></code> value of <em>X</em>
and <code class="docutils literal notranslate"><span class="pre">106th</span></code> value of <em>Y</em>.</p>
<p>The pair of <code class="docutils literal notranslate"><span class="pre">Indices</span></code> datasets are critical for explaining:</p>
<ul class="simple">
<li>the original dimensionality of the dataset</li>
<li>how to reshape the data back to its N dimensional form</li>
</ul>
<p>Much like <code class="docutils literal notranslate"><span class="pre">main</span></code> datasets, the <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets are also two
dimensional matrices regardless of the number of <code class="docutils literal notranslate"><span class="pre">position</span></code> or
<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code>. Given a <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset with <code class="docutils literal notranslate"><span class="pre">N</span></code> positions,
each containing <code class="docutils literal notranslate"><span class="pre">P</span></code> spectral values (shape = (<code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">P</span></code>)), and having
<code class="docutils literal notranslate"><span class="pre">U</span></code> <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code> and  <code class="docutils literal notranslate"><span class="pre">V</span></code> <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code>:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code> and <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> datasets would both of the
same size of <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">U</span></code>, where <code class="docutils literal notranslate"><span class="pre">U</span></code> is the number of <code class="docutils literal notranslate"><span class="pre">position</span>
<span class="pre">dimensions</span></code>. The <strong>columns would be arranged in ascending order of rate of
change</strong>. In other words, the first column would be the fastest changing
position dimension and the last column would be the slowest. <strong>Each position dimension gets it’s own column</strong>.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code> and <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code> dataset would
both be <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">x</span> <span class="pre">S</span></code> in shape, where <code class="docutils literal notranslate"><span class="pre">V</span></code> is the number of <code class="docutils literal notranslate"><span class="pre">spectroscopic</span>
<span class="pre">dimensions</span></code>. Similarly to the <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code>, the first row would be
the fastest changing <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code> while the last row would be
the slowest varying dimension. <strong>Each spectroscopic dimension gets it’s own row</strong>.</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets are better illustrated via a few examples. We will
be continuing with the same examples used when illustrating the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset.</p>
<div class="section" id="id2">
<h4><a class="toc-backref" href="#id27">Spectrum</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume that data points were collected as a function of 8 values of the (sole) variable / <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code> -
<em>Frequency</em>.  In that case, the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code> dataset would be of size <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">5</span></code> (one row for the single
<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code> and eight columns for each of the reference <em>Frequency</em> steps.
Let’s assume that the data was collected as a function of <em>Frequency</em> over a band ranging from <code class="docutils literal notranslate"><span class="pre">300</span></code> to <code class="docutils literal notranslate"><span class="pre">320</span></code> kHz.
In that case, the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code> would be as shown below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Frequency</strong></td>
<td>300</td>
<td>305</td>
<td>310</td>
<td>315</td>
<td>320</td>
</tr>
</tbody>
</table>
<p>This means that for all positions in the <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset, the <code class="docutils literal notranslate"><span class="pre">4th</span></code> column would always correspond to data collected
for the <em>Frequency</em> of <code class="docutils literal notranslate"><span class="pre">315</span> <span class="pre">kHz</span></code>.</p>
<p>As the name suggests, the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code> dataset only shows the indices for the steps in the dimension.
In this particular case, the dataset is trivial and just a linearly increasing array.</p>
<p>Note that indices start from <code class="docutils literal notranslate"><span class="pre">0</span></code> instead of <code class="docutils literal notranslate"><span class="pre">1</span></code> and
end at <code class="docutils literal notranslate"><span class="pre">5-1</span></code> instead of <code class="docutils literal notranslate"><span class="pre">5</span></code> in line with common programming languages such as <em>C</em> or <em>python</em> as shown below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Frequency</strong></td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>Given that the spectrum only had a single <em>arbitrary</em> <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimension</span></code> which was varied over a single (arbitrary)
value, the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code> and <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> datasets would have a shape of <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">1</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>arb.</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>arb.</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0.0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gray-scale-image">
<h4><a class="toc-backref" href="#id28">Gray-scale image</a><a class="headerlink" href="#gray-scale-image" title="Permalink to this headline">¶</a></h4>
<p>A simple gray-scale image with <code class="docutils literal notranslate"><span class="pre">X</span></code> pixels in the horizontal and <code class="docutils literal notranslate"><span class="pre">Y</span></code> pixels in the vertical
direction would have ancillary position
datasets of shape <code class="docutils literal notranslate"><span class="pre">X*Y</span> <span class="pre">x</span> <span class="pre">2</span></code>. The first column in the ancillary position
datasets would correspond to the index / values of the dimension - <code class="docutils literal notranslate"><span class="pre">X</span></code>
(assuming that it is the dimension that varies fastest)
and the second column in the ancillary position dataset would be the dimension - <code class="docutils literal notranslate"><span class="pre">Y</span></code>
assuming that the data was collected column-by-column and then row-by-row just as in the example above.</p>
<p>If the original image had 3 pixels in the horizontal direction and 2 pixels in the vertical direction,
the corresponding <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code> dataset would be:</p>
<table border="1" class="docutils">
<colgroup>
<col width="58%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">X</th>
<th class="head">Y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
</tr>
<tr class="row-even"><td>1</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Notice that the index for <code class="docutils literal notranslate"><span class="pre">X</span></code> is reset to <code class="docutils literal notranslate"><span class="pre">0</span></code> when <code class="docutils literal notranslate"><span class="pre">Y</span></code> is incremented from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code> in the fourth row.
As mentioned earlier, the data in such <code class="docutils literal notranslate"><span class="pre">Indices</span></code> datasets are essentially counters.</p>
<p>Correspondingly, if the measurements were performed at <code class="docutils literal notranslate"><span class="pre">X</span></code> locations:
<code class="docutils literal notranslate"><span class="pre">0.0,</span> <span class="pre">1.5,</span> <span class="pre">and</span> <span class="pre">3.0</span></code> <em>microns</em> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> locations: <code class="docutils literal notranslate"><span class="pre">-70</span></code> and <code class="docutils literal notranslate"><span class="pre">23</span></code> <em>nanometers</em>,
the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> dataset may look like the table below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">X</th>
<th class="head">Y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0.0</td>
<td>-70.0</td>
</tr>
<tr class="row-odd"><td>1.5</td>
<td>-70.0</td>
</tr>
<tr class="row-even"><td>3.0</td>
<td>-70.0</td>
</tr>
<tr class="row-odd"><td>0.0</td>
<td>23.0</td>
</tr>
<tr class="row-even"><td>1.5</td>
<td>23.0</td>
</tr>
<tr class="row-odd"><td>3.0</td>
<td>23.0</td>
</tr>
</tbody>
</table>
<p>Thus, the <code class="docutils literal notranslate"><span class="pre">5th</span></code> row in the <code class="docutils literal notranslate"><span class="pre">main</span> <span class="pre">dataset</span></code> for this gray-scale image would correspond to data collected
at <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">=</span> <span class="pre">1.5</span> <span class="pre">microns</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span> <span class="pre">=</span> <span class="pre">23</span> <span class="pre">nanometers</span></code> according to the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> dataset.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> dimensions have <strong>different units</strong> - microns and nanometers.
Pycroscopy has been designed to handle variations in the units for
each of these dimensions. Details regarding how and where to store
the information regarding the <code class="docutils literal notranslate"><span class="pre">labels</span></code> (‘X’, ‘Y’) and <code class="docutils literal notranslate"><span class="pre">units</span></code> for
these dimensions (‘um’, ‘nm’) will be discussed in the <code class="docutils literal notranslate"><span class="pre">Implementation</span></code> section.</p>
<p>Similar to the <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code> for a spectrum, gray-scale images only have a single <em>arbitrary</em>
<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code>. Thus, both <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span></code> datasets have shape of <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">1</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="69%" />
<col width="31%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>arb.</strong></td>
<td>0</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="69%" />
<col width="31%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>arb.</strong></td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h4><a class="toc-backref" href="#id29">Spectral maps</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Let’s continue the example on <strong>spectral maps</strong>, which has two <code class="docutils literal notranslate"><span class="pre">position</span>
<span class="pre">dimensions</span></code> - <em>X</em> and <em>Y</em>, and one <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimension</span></code> - <em>Frequency</em>.
If the dataset was varied over <code class="docutils literal notranslate"><span class="pre">3</span></code> values of <em>X</em>, <code class="docutils literal notranslate"><span class="pre">2</span></code> values of <em>Y</em> and <code class="docutils literal notranslate"><span class="pre">5</span></code> values of <em>Frequency</em>, the
<code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets would be based on the solutions for the two examples above:</p>
<p><code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="58%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">X</th>
<th class="head">Y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
</tr>
<tr class="row-even"><td>1</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">X</th>
<th class="head">Y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0.0</td>
<td>-70.0</td>
</tr>
<tr class="row-odd"><td>1.5</td>
<td>-70.0</td>
</tr>
<tr class="row-even"><td>3.0</td>
<td>-70.0</td>
</tr>
<tr class="row-odd"><td>0.0</td>
<td>23.0</td>
</tr>
<tr class="row-even"><td>1.5</td>
<td>23.0</td>
</tr>
<tr class="row-odd"><td>3.0</td>
<td>23.0</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Frequency</strong></td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Frequency</strong></td>
<td>300</td>
<td>305</td>
<td>310</td>
<td>315</td>
<td>320</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id4">
<h4><a class="toc-backref" href="#id30">High dimensional data</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Continuing with the expansion of the <strong>spectral maps</strong> example - if the data was recorded as a function of <code class="docutils literal notranslate"><span class="pre">3</span></code>
<em>Temperatures</em> in addition to recording data as a function of <em>Frequency</em> as in the above example, we wold have two
<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> - <em>Frequency</em>, and <em>Temperature</em>. Thus, the <code class="docutils literal notranslate"><span class="pre">ancillary</span> <span class="pre">spectroscopic</span></code> datasets would
now have a shape of <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">5*3</span></code> instead of the simpler <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">5</span></code>. The value <code class="docutils literal notranslate"><span class="pre">2</span></code> on the first index corresponds to
the two <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> and the longer (<code class="docutils literal notranslate"><span class="pre">15</span></code> instead of <code class="docutils literal notranslate"><span class="pre">5</span></code>) second axis corresponds to the fact
that the spectra is now recorded thrice at each position (once for each <em>Frequency</em>). Assuming that the <em>Frequency</em>
varies faster than the <em>Temperature</em> dimension (i.e.- the <em>Frequency</em> is varied from <code class="docutils literal notranslate"><span class="pre">300</span></code> to <code class="docutils literal notranslate"><span class="pre">320</span></code> for a
<em>Temperature</em> of <code class="docutils literal notranslate"><span class="pre">30</span> <span class="pre">C</span></code>, <strong>then</strong> the <em>Frequency</em> is varied from <code class="docutils literal notranslate"><span class="pre">300</span></code> to <code class="docutils literal notranslate"><span class="pre">320</span></code> for a <em>Temperature</em> of <code class="docutils literal notranslate"><span class="pre">40</span> <span class="pre">C</span></code>
and so on), the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code> would be as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Frequency</strong></td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="row-even"><td><strong>Temperature</strong></td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Correspondingly, the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Values</span></code> would look like:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Frequency</strong></td>
<td>300</td>
<td>305</td>
<td>310</td>
<td>315</td>
<td>320</td>
<td>300</td>
<td>305</td>
<td>310</td>
<td>315</td>
<td>320</td>
<td>300</td>
<td>305</td>
<td>310</td>
<td>315</td>
<td>320</td>
</tr>
<tr class="row-even"><td><strong>Temperature</strong></td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>40</td>
<td>40</td>
<td>40</td>
<td>40</td>
<td>40</td>
<td>50</td>
<td>50</td>
<td>50</td>
<td>50</td>
<td>50</td>
</tr>
</tbody>
</table>
<p>Since the manner and values over which the positions are varied remains unchanged from the <em>spectral maps</em> example,
the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code> and <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Values</span></code> datasets for this example would be identical those of the <em>spectral maps</em> example</p>
<p>A simple glance at the shape of the <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets for this (or any) example would be enough to
reveal that the data has two <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">dimensions</span></code> (two columns in the <code class="docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Indices</span></code> dataset) and
two <code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> (two rows in the <code class="docutils literal notranslate"><span class="pre">Spectroscopic</span> <span class="pre">Indices</span></code> dataset)
dataset)</p>
<p>In the same manner, additional dimensions can be added to the <code class="docutils literal notranslate"><span class="pre">main</span></code> and appropriate <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets
thus proving that this data model can indeed accommodate data of any size, complexity, or dimensionality.</p>
</div>
</div>
<div class="section" id="channels">
<h3><a class="toc-backref" href="#id31">Channels</a><a class="headerlink" href="#channels" title="Permalink to this headline">¶</a></h3>
<p>The <strong>USID</strong> model also allows the representation and capture of <strong>information acquired
simultaneously from multiple sources</strong> through <code class="docutils literal notranslate"><span class="pre">Channels</span></code>.
Each <code class="docutils literal notranslate"><span class="pre">Channel</span></code> would contain a <strong>separate</strong> <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset. <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets
can be shared across channels if the position or spectroscopic dimensions are identical.</p>
<p>As alluded to earlier, the most popular example many people can relate to are the various channels
of information recorded during a conventional scanning probe microscopy raster scan (<em>Height</em>, <em>Amplitude</em>, <em>Phase</em>).
For this example, all the <code class="docutils literal notranslate"><span class="pre">channels</span></code> could share the same set of four <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets.</p>
<p>It is not necessary that rate of acquisition match across <code class="docutils literal notranslate"><span class="pre">channels</span></code>. For example, one
<code class="docutils literal notranslate"><span class="pre">channel</span></code> could be a high-resolution topography scan (similar to 2D gray-scale image)
while another <code class="docutils literal notranslate"><span class="pre">channel</span></code> could contain spectra collected at each location on a
<strong>coarser</strong> grid of positions (3D spectral-map dataset). In this case, the two
<code class="docutils literal notranslate"><span class="pre">channels</span></code> may not be able to share <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> datasets.</p>
<p>Specifics regarding the implementation of different
channels will be discussed in a later section.</p>
</div>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id32">File Format</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<div class="section" id="requirements">
<h3><a class="toc-backref" href="#id33">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>No one really wants yet another file format in their lives. We wanted to adopt a file format that satisfies some basic requirements:</p>
<ul class="simple">
<li>already widely accepted in scientific research</li>
<li>support parallel read and write capabilities.</li>
<li>store multiple datasets of different shapes, dimensionalities, precision and sizes.</li>
<li>scale very efficiently from few kilobytes to several terabytes</li>
<li>can be (readily) read and modified using any language including Python, R, Matlab,
C/C++, Java, Fortran, Igor Pro, etc. without requiring installation of modules that are hard to install</li>
<li>store and organize data in a intuitive and familiar hierarchical / tree-like
structure that is similar to files and folders in personal computers.</li>
<li>facilitates storage of any number of experimental or analysis parameters
in addition to regular data.</li>
<li>highly flexible and poses minimal restrictions on how the data can and should be stored.</li>
<li>readily compatible with high-performance computing (<code class="docutils literal notranslate"><span class="pre">HPC</span></code>) and (soon) cloud-computing.</li>
</ul>
</div>
<div class="section" id="candidates">
<h3><a class="toc-backref" href="#id34">Candidates</a><a class="headerlink" href="#candidates" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>We found that existing file formats in science such as the <a class="reference external" href="http://www.nexusformat.org">Nexus data format</a>,
<a class="reference external" href="http://www.xdmf.org/index.php/Main_Page">XDMF</a>, and <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a>:<ul>
<li>were designed for <strong>specific / narrow scientific domains only</strong> and we did not want to shoehorn our data structure into those formats.</li>
<li>Furthermore, despite being some of the more popular scientific data formats, it is <strong>not immediately straightforward to read those files</strong>
on every computer using any programming language. For example - the <a class="reference external" href="https://www.anaconda.com/what-is-anaconda/">Anaconda</a>
python distribution does not come with any packages for reading these file formats.</li>
</ul>
</li>
<li><a class="reference external" href="https://www.olcf.ornl.gov/center-projects/adios/">Adios</a> is perhaps the ultimate file format for storing petabyte sized data on supercomputers but
it was specifically designed for simulations, check-pointing, and it trades flexibility, and ease-of-use for performance.</li>
<li>The <a class="reference external" href="https://support.hdfgroup.org/HDF5/doc/H5.intro.html">hierarchical data format (HDF5)</a> is the implicitly or explicitly the
<a class="reference external" href="https://support.hdfgroup.org/HDF5/users5.html">de-facto standard in scientific research</a>.
In fact, Nexus, NetCDF, and even <a class="reference external" href="https://www.mathworks.com/help/matlab/import_export/mat-file-versions.html">Matlab’s .mat</a>
files are actually (now) just custom flavors of HDF5 thereby validating the statement that HDF5 is the <strong>unanimous the file format of choice</strong></li>
<li>The <a class="reference external" href="http://dream3d.bluequartz.net/binaries/Help/DREAM3D/nativedream3d.html">DREAM.3D</a> is yet another group that uses HDF5
as the base container to store their data. We are currently evaluating compatibility with and feasibility of their data model.</li>
</ul>
<p>We found that <a class="reference external" href="http://extremecomputingtraining.anl.gov/files/2015/03/HDF5-Intro-aug7-130.pdf">HDF5</a>, works best for us compared to the alternatives.
Hence, we have implemented the <strong>USID</strong> model into the HDF5 file format and such file will be referred to as <strong>h5USID</strong> files.</p>
<p>We acknowledge that it is nearly impossible to find the perfect file format and HDF5 too has its fair share of drawbacks.
One common observation among file formats is that a file format optimized for the cloud or cluster computing often does
not perform well (or at all) on HPC due to the conflicting nature of the computing paradigms.
As of this writing, HDF5 is optimized for HPC and not for cloud-based applications.
For cloud-based environments it is beneficial to in fact break up the data into
small chunks that can be individually addressed and used. We think <a class="reference external" href="https://zarr.readthedocs.io/en/stable/">Zarr</a> and
<a class="reference external" href="https://github.com/saalfeldlab/n5">N5</a> would be good alternatives; however, most of these file formats are very much in
their infancy and have not proven themselves like HDF5 has. This being said, the HDF organization
<a class="reference external" href="https://www.youtube.com/watch?v=3tP3lT5y-QA">just announced</a> a <a class="reference external" href="https://www.hdfgroup.org/solutions/hdf-cloud/">cloud flavor</a>
of HDF5 and we plan to look into this once h5py or other python packages support such capabilities.</p>
</div>
</div>
<div class="section" id="h5usid-usid-in-hdf5">
<h2><a class="toc-backref" href="#id35">h5USID - USID in HDF5</a><a class="headerlink" href="#h5usid-usid-in-hdf5" title="Permalink to this headline">¶</a></h2>
<p>Here we discuss guidelines and specifications for implementing the <strong>USID</strong> model into HDF5 files.
While we could impose that the file extension be changed from <strong>.hdf5</strong> to <strong>.h5USID</strong>, we choose to retain
the <strong>.hdf5</strong> extension so that other software are aware of the general file type and can recognize / read them easily.</p>
<div class="section" id="quick-basics-of-hdf5">
<h3><a class="toc-backref" href="#id36">Quick basics of HDF5</a><a class="headerlink" href="#quick-basics-of-hdf5" title="Permalink to this headline">¶</a></h3>
<p>Information can be stored in HDF5 files in several ways:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Datasets</span></code> allow the storage of data matrices and these are the vessels used for storing the <code class="docutils literal notranslate"><span class="pre">main</span></code>,
<code class="docutils literal notranslate"><span class="pre">ancillary</span></code>, and any extra data matrices</li>
<li><code class="docutils literal notranslate"><span class="pre">Groups</span></code> are similar to folders in conventional file systems and can be used to store any number of datasets or
groups themselves</li>
<li><code class="docutils literal notranslate"><span class="pre">Attributes</span></code> are small pieces of information, such as experimental or analytical parameters, that are stored in
key-value pairs in the same way as dictionaries in python.  Both groups and datasets can store attributes.</li>
<li>While they are not means to store data, <code class="docutils literal notranslate"><span class="pre">Links</span></code> or <code class="docutils literal notranslate"><span class="pre">references</span></code> can be used to provide shortcuts and aliases to
datasets and groups. This feature is especially useful for avoiding duplication of datasets when two <code class="docutils literal notranslate"><span class="pre">main</span></code>
datasets use the same ancillary datasets.</li>
</ul>
</div>
<div class="section" id="main-data">
<h3><a class="toc-backref" href="#id37"><code class="docutils literal notranslate"><span class="pre">Main</span></code> data:</a><a class="headerlink" href="#main-data" title="Permalink to this headline">¶</a></h3>
<p><strong>Dataset</strong> structured as (positions x time or spectroscopic values)</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dtype</span></code> : uint8, float32, complex64, compound if necessary, etc.</li>
<li><em>Required</em> attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">quantity</span></code> - Single string that explains the data. The physical
quantity contained in each cell of the dataset – eg –
‘Current’ or ‘Deflection’</li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> – Single string for units. The units for the physical
quantity like ‘nA’, ‘V’, ‘pF’, etc.</li>
<li><code class="docutils literal notranslate"><span class="pre">Position_Indices</span></code> - Reference to the position indices dataset</li>
<li><code class="docutils literal notranslate"><span class="pre">Position_Values</span></code> - Reference to the position values dataset</li>
<li><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code> - Reference to the spectroscopic indices
dataset</li>
<li><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code> - Reference to the spectroscopic values
dataset</li>
</ul>
</li>
<li><a class="reference external" href="https://support.hdfgroup.org/HDF5/doc1.8/Advanced/Chunking/index.html">chunking</a>
: HDF group recommends that chunks be between 100 kB to 1 MB. We
recommend chunking by whole number of positions since data is more
likely to be read by position rather than by specific spectral indices.</li>
</ul>
<p>Note that we are only storing references to the ancillary datasets. This
allows multiple <code class="docutils literal notranslate"><span class="pre">main</span></code> datasets to share the same ancillary datasets
without having to duplicate them.</p>
</div>
<div class="section" id="ancillary-data">
<h3><a class="toc-backref" href="#id38"><code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> data:</a><a class="headerlink" href="#ancillary-data" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Position_Indices</span></code> structured as (<code class="docutils literal notranslate"><span class="pre">positions</span></code> x <code class="docutils literal notranslate"><span class="pre">spatial</span> <span class="pre">dimensions</span></code>)</p>
<ul class="simple">
<li>dimensions are arranged in ascending order of rate of change. In other
words, the fastest changing dimension is in the first column and the
slowest is in the last or rightmost column.</li>
<li><code class="docutils literal notranslate"><span class="pre">dtype</span></code> : uint32</li>
<li>Required attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> - list of strings for the column names like [‘X’, ‘Y’]</li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> – list of strings for units like [‘um’, ‘nm’]</li>
</ul>
</li>
<li>Optional attributes:
* Region references based on column names</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Position_Values</span></code> structured as (<code class="docutils literal notranslate"><span class="pre">positions</span></code> x <code class="docutils literal notranslate"><span class="pre">spatial</span> <span class="pre">dimensions</span></code>)</p>
<ul class="simple">
<li>dimensions are arranged in ascending order of rate of change. In other
words, the fastest changing dimension is in the first column and the
slowest is in the last or rightmost column.</li>
<li><code class="docutils literal notranslate"><span class="pre">dtype</span></code> : float32</li>
<li>Required attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> - list of strings for the column names like [‘X’, ‘Y’]</li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> – list of strings for units like [‘um’, ‘nm’]</li>
</ul>
</li>
<li>Optional attributes:
* Region references based on column names</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code> structured as (<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> x
<code class="docutils literal notranslate"><span class="pre">time</span></code>)</p>
<ul class="simple">
<li>dimensions are arranged in ascending order of rate of change.
In other words, the fastest changing dimension is in the first row and
the slowest is in the last or lowermost row.</li>
<li><code class="docutils literal notranslate"><span class="pre">dtype</span></code> : uint32</li>
<li>Required attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> - list of strings for the column names like [‘Bias’, ‘Cycle’]</li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> – list of strings for units like [‘V’, ‘’].
Empty string for dimensionless quantities</li>
</ul>
</li>
<li>Optional attributes:
* Region references based on row names</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code> structured as (<code class="docutils literal notranslate"><span class="pre">spectroscopic</span> <span class="pre">dimensions</span></code> x
<code class="docutils literal notranslate"><span class="pre">time</span></code>)</p>
<ul class="simple">
<li>dimensions are arranged in ascending order of rate of change.
In other words, the fastest changing dimension is in the first row and
the slowest is in the last or lowermost row.</li>
<li><code class="docutils literal notranslate"><span class="pre">dtype</span></code> : float32</li>
<li>Required attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> - list of strings for the column names like [‘Bias’, ‘Cycle’]</li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> – list of strings for units like [‘V’, ‘’].
Empty string for dimensionless quantities</li>
</ul>
</li>
<li>Optional attributes:<ul>
<li>Region references based on row names</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="attributes">
<h3><a class="toc-backref" href="#id39">Attributes</a><a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>All groups and (at least <code class="docutils literal notranslate"><span class="pre">Main</span></code>) datasets must be created with the following <strong>mandatory</strong> attributes for better traceability:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">time_stamp</span></code> : ‘2017_08_15-22_15_45’ (date and time of creation
of the group or dataset formatted as ‘YYYY_MM_DD-HH_mm_ss’ as
a string)</li>
<li><code class="docutils literal notranslate"><span class="pre">machine_id</span></code> : ‘mac1234.ornl.gov’ (a fully qualified domain name as
a string)</li>
<li><code class="docutils literal notranslate"><span class="pre">pyUSID_version</span></code> : ‘0.0.1’</li>
<li><code class="docutils literal notranslate"><span class="pre">platform</span></code> : ‘Windows10….’ or something like ‘Darwin-17.4.0-x86_64-i386-64bit’ (for Mac OS) -
a long string providing detailed information about the operating system</li>
</ul>
</div>
<div class="section" id="groups">
<h3><a class="toc-backref" href="#id40">Groups</a><a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h3>
<p>HDF5 Groups in <strong>h5USID</strong> are used to organize categories of information (raw measurements from instruments, results from data analysis, etc.) in an intuitive manner.</p>
<div class="section" id="measurement-data">
<h4><a class="toc-backref" href="#id41">Measurement data</a><a class="headerlink" href="#measurement-data" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>As mentioned earlier, instrument users may change experimental
parameters during measurements. Even if these changes are minor, they
can lead to misinterpretation of data if the changes are not handled
robustly. To solve this problem, we recommend storing data under <strong>indexed</strong>
groups named as <code class="docutils literal notranslate"><span class="pre">Measurement_00x</span></code>. Each time the parameters
are changed, the dataset is truncated to the point until which data
was collected and a new group is created to store the upcoming
new measurement data.</li>
<li>Each <strong>channel</strong> of information acquired during the measurement gets
its own group.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets would reside within these channel groups.</li>
<li>Similar to the measurement groups, the channel groups are
named as <code class="docutils literal notranslate"><span class="pre">Channel_00x</span></code>. The index for the group is incremented
according to the index of the information channel.</li>
<li>Depending on the circumstances, the ancillary datasets can be shared
among channels.<ul>
<li>Instead of the main dataset in <code class="docutils literal notranslate"><span class="pre">Channel_001</span></code> having references to
the ancillary datasets in <code class="docutils literal notranslate"><span class="pre">Channel_000</span></code>, we recommend placing the
ancillary datasets outside the Channel groups in a area common
to both channel groups. Typically, this is the
<code class="docutils literal notranslate"><span class="pre">Measurement_00x</span></code> group.</li>
</ul>
</li>
<li>This is what the tree structure in the file looks like when
experimental parameters were changed twice and there are two channels
of information being acquired during the measurements.</li>
<li>Datasets common to all measurement groups (perhaps some calibration
data that is acquired only once before all measurements)</li>
<li><code class="docutils literal notranslate"><span class="pre">Measurement_000</span></code> (group)<ul>
<li><code class="docutils literal notranslate"><span class="pre">Channel_000</span></code> (group)<ul>
<li>Datasets here</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">Channel_001</span></code> (group)<ul>
<li>Datasets here</li>
</ul>
</li>
<li>Datasets common to <code class="docutils literal notranslate"><span class="pre">Channel_000</span></code> and <code class="docutils literal notranslate"><span class="pre">Channel_001</span></code></li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">Measurement_001</span></code> (group)<ul>
<li><code class="docutils literal notranslate"><span class="pre">Channel_000</span></code> (group)<ul>
<li>Datasets here</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">Channel_001</span></code> (group)<ul>
<li>Datasets here</li>
</ul>
</li>
<li>Datasets common to <code class="docutils literal notranslate"><span class="pre">Channel_000</span></code> and <code class="docutils literal notranslate"><span class="pre">Channel_001</span></code></li>
</ul>
</li>
<li>…</li>
</ul>
</div>
<div class="section" id="tool-analysis-processing">
<h4><a class="toc-backref" href="#id42">Tool (analysis / processing)</a><a class="headerlink" href="#tool-analysis-processing" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Each time an analysis or processing routine, referred generally as
<code class="docutils literal notranslate"><span class="pre">tool</span></code>, is performed on a dataset of interest, the results are
stored in new HDF5 datasets within a new HSF5 group.</p>
</li>
<li><p class="first">A completely new dataset(s) and group are created even if a minor
operation is being performed on the dataset. In other words, we <strong>do NOT modify existing datasets</strong>.</p>
</li>
<li><p class="first">Almost always, the tool is applied to one (or more) <code class="docutils literal notranslate"><span class="pre">main</span></code> datasets (referred to
as the <code class="docutils literal notranslate"><span class="pre">source</span></code> dataset) and at least one of the results is
typically also a <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset. These new <code class="docutils literal notranslate"><span class="pre">main</span></code> datasets will
either need to be linked to the ancillary matrices of the <code class="docutils literal notranslate"><span class="pre">source</span></code>
or to new ancillary datasets that will need to be created.</p>
</li>
<li><p class="first">The resultant dataset(s) are always stored in a group whose name
is derived from the names of the tool and the dataset. This makes the
data <strong>traceable</strong>, meaning that the names of the datasets and
groups are sufficient to understand what processing or analysis
steps were applied to the data to bring it to a particular point.</p>
</li>
<li><p class="first">The group is named as <code class="docutils literal notranslate"><span class="pre">Source_Dataset-Tool_Name_00x</span></code>, where a
<code class="docutils literal notranslate"><span class="pre">tool</span></code> named <code class="docutils literal notranslate"><span class="pre">Tool_Name</span></code> is applied to a <code class="docutils literal notranslate"><span class="pre">main</span></code> dataset named
<code class="docutils literal notranslate"><span class="pre">Source_Dataset</span></code>.</p>
<ul class="simple">
<li>Since there is a possibility that the same tool could be applied
to the very same dataset multiple times, we store the results of
each run of the tool in a separate group. These groups are
differentiated by the index that is appended to the name of
the group.</li>
<li>Note that a <code class="docutils literal notranslate"><span class="pre">-</span></code> separates the dataset name from the tool name
and anything after the last <code class="docutils literal notranslate"><span class="pre">_</span></code> will be assumed to be the index
of the group</li>
<li>Please refer to the advanced topics section for tools that have <strong>more than one</strong>
<code class="docutils literal notranslate"><span class="pre">source</span></code> datasets</li>
</ul>
</li>
<li><p class="first">In general, the results from tools applied to datasets should be
stored as:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Source_Dataset</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Source_Dataset-Tool_Name_000</span></code> (group containing results from
first run of the <code class="docutils literal notranslate"><span class="pre">tool</span></code> on <code class="docutils literal notranslate"><span class="pre">Source_Dataset</span></code>)<ul>
<li>Attributes:<ul>
<li>all mandatory attributes</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code></li>
<li>Other tool-relevant attributes</li>
<li><code class="docutils literal notranslate"><span class="pre">source_000</span></code> - reference to <code class="docutils literal notranslate"><span class="pre">Source_Dataset</span></code></li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">Dataset_Result0</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Dataset_Result1</span></code> …</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">Source_Dataset-Tool_Name_001</span></code> (group containing results from
second run of the <code class="docutils literal notranslate"><span class="pre">tool</span></code> on <code class="docutils literal notranslate"><span class="pre">Source_Dataset</span></code>)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">This methodology is illustrated with an example of applying
<code class="docutils literal notranslate"><span class="pre">K-Means</span> <span class="pre">Clustering</span></code> on the <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code> acquired from a measurement:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code> (<code class="docutils literal notranslate"><span class="pre">main</span></code> dataset)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Raw_Data-Cluster_000</span></code> (group)</p>
</li>
<li><p class="first">Attributes:</p>
<blockquote>
<div><ul class="simple">
<li>all mandatory attributes</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> : ‘K-Means’</li>
<li><code class="docutils literal notranslate"><span class="pre">source_000</span></code> : reference to <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Label_Indices</span></code> (ancillary spectroscopic dataset with 1 dimension of size 1)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Label_Values</span></code> (ancillary spectroscopic dataset with 1 dimension of size 1)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Labels</span></code> (Main dataset)</p>
<ul class="simple">
<li>Attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">quantity</span></code> : ‘Cluster labels’</li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> : ‘a. u.’</li>
<li><code class="docutils literal notranslate"><span class="pre">Position_Indices</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Position_Indices</span></code> from
attribute of <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Position_Values</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Position_Values</span></code> from
attribute of <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Label_Indices</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Label_Values</span></code></li>
<li>all mandatory attributes</li>
</ul>
</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Cluster_Indices</span></code> (ancillary positions dataset with 1 dimension of size equal to number of clusters)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Cluster_Values</span></code> (ancillary positions dataset with 1 dimension of size equal to number of clusters)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Mean_Response</span></code> (main dataset) &lt;- This dataset stores the endmembers
or mean response for each cluster</p>
<ul class="simple">
<li>Attributes:<ul>
<li><code class="docutils literal notranslate"><span class="pre">quantity</span></code> : copy from the <code class="docutils literal notranslate"><span class="pre">quantity</span></code> attribute in
<code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">units</span></code> : copy from the <code class="docutils literal notranslate"><span class="pre">units</span></code> attribute in <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Position_Indices</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Cluster_Indices</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Position_Values</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Cluster_Values</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code>
from attribute of <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code> : Reference to <code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code>
from attribute of <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code></li>
<li>all mandatory attributes</li>
</ul>
</li>
</ul>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Note that the spectroscopic datasets that the <code class="docutils literal notranslate"><span class="pre">Labels</span></code> dataset link
to are not called <code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code> or
<code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code> themselves. They only need to follow the
specifications outlined above. The same is true for the position
datasets for <code class="docutils literal notranslate"><span class="pre">Mean_Response</span></code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="advanced-topics">
<h2><a class="toc-backref" href="#id43">Advanced topics</a><a class="headerlink" href="#advanced-topics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="region-references">
<h3><a class="toc-backref" href="#id44"><code class="docutils literal notranslate"><span class="pre">Region</span> <span class="pre">references</span></code></a><a class="headerlink" href="#region-references" title="Permalink to this headline">¶</a></h3>
<p>These are references to sections of a <code class="docutils literal notranslate"><span class="pre">main</span></code> or <code class="docutils literal notranslate"><span class="pre">ancillary</span></code> dataset that make it easy to access data specific to a
specific portion of the measurement, or each column or row in the ancillary datasets just by their alias (intuitive
strings for names).</p>
<p>We have observed that the average <strong>USID</strong> user does not tend to use region references as much as we thought they
might. Therefore, we do not require or enforce that region references be used</p>
</div>
<div class="section" id="processing-on-multiple-main-datasets">
<h3><a class="toc-backref" href="#id45">Processing on multiple <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets</a><a class="headerlink" href="#processing-on-multiple-main-datasets" title="Permalink to this headline">¶</a></h3>
<p>One popular scientific workflow we anticipate involves the usage of multiple <code class="docutils literal notranslate"><span class="pre">source</span></code> datasets to create results.
By definition, this breaks the current nomenclature of HDF5 groups that will contain results. This will be addressed by
restructuring the code in such a way that the results group could be named as: <code class="docutils literal notranslate"><span class="pre">Multi_Dataset-Tool_Name_000</span></code>. To improve
the robustness of the solution, we have already begun storing the necessary information as attributes of the HDF5
results groups. Here are the attributes of the group that we expect to capture the references to all the datasets along
with the name of the tool while relaxing the restrictions on the aforementioned nomenclature:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tool</span></code> : &lt;string&gt; - Name of the tool / process applied to the datasets</li>
<li><code class="docutils literal notranslate"><span class="pre">num_sources</span></code>: &lt;unsigned integer&gt; - Number of source datasets that take part in the process</li>
<li><code class="docutils literal notranslate"><span class="pre">source_000</span></code> : &lt;HDF5 object reference&gt; - reference to the first source dataset</li>
<li><code class="docutils literal notranslate"><span class="pre">source_001</span></code> : &lt;HDF5 object reference&gt; - reference to the second source dataset …</li>
</ul>
<p>We would have to break the list of references to the source datasets into individual attributes since h5py / HDF5
currently does not allow the value of an attribute to be a list of object references.</p>
</div>
<div class="section" id="sparse-sampling-compressed-sensing">
<h3><a class="toc-backref" href="#id46">Sparse Sampling / Compressed Sensing</a><a class="headerlink" href="#sparse-sampling-compressed-sensing" title="Permalink to this headline">¶</a></h3>
<p>In many cases, especially electron and ion based microscopy, the very act of probing the sample damages the sample.
In order to minimize damage to the sample, researchers only sample data from a few random positions in the 2D grid of
positions and use advanced algorithms to reconstruct the missing data. This scientific problem presents a data storage
challenge. The naive approach would be to store a giant matrix of zeros with only a available positions filled in.
This is highly inefficient since the space occupied by the data would be equal to that of the complete (non-sparse)
dataset.</p>
<p>For such sparse sampling problems, we propose that the indices for each position be identical and still range from <code class="docutils literal notranslate"><span class="pre">0</span></code>
to <code class="docutils literal notranslate"><span class="pre">N-1</span></code> for a dataset with <code class="docutils literal notranslate"><span class="pre">N</span></code> randomly sampled positions. Thus, for an example dataset with two position dimensions,
the indices would be arranged as:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">X</th>
<th class="head">Y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>1</td>
</tr>
<tr class="row-even"><td>2</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>.</td>
<td>.</td>
</tr>
<tr class="row-even"><td>N-2</td>
<td>N-2</td>
</tr>
<tr class="row-odd"><td>N-1</td>
<td>N-1</td>
</tr>
</tbody>
</table>
<p>However, the position values would contain the actual values:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">X</th>
<th class="head">Y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>9.5</td>
<td>1.5</td>
</tr>
<tr class="row-odd"><td>3.6</td>
<td>7.4</td>
</tr>
<tr class="row-even"><td>5.4</td>
<td>8.2</td>
</tr>
<tr class="row-odd"><td>.</td>
<td>.</td>
</tr>
<tr class="row-even"><td>1.2</td>
<td>3.9</td>
</tr>
<tr class="row-odd"><td>4.8</td>
<td>6.1</td>
</tr>
</tbody>
</table>
<p>The spectroscopic ancillary datasets would be constructed and defined in the traditional methods since the sampling in
the spectroscopic dimension is identical for all measurements.</p>
<p>The vast majority of the existing features including signal filtering, statistical machine learning algorithms, etc. in
child packages like pycroscopy could still be applied to such datasets.</p>
<p>By nature of its definition, such a dataset will certainly pose problems when attempting to reshape to its N-dimensional
form among other things. Pycroscopy currently does not have any scientific algorithms or real datasets specifically
written for such data but this will be addressed in the near future. This is section is presented to show that we
have indeed thought about such advanced problems as well when designing the universal data structure.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contribution_guidelines.html" class="btn btn-neutral float-right" title="Guidelines for Contribution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="auto_examples/cookbooks/plot_io_utils.html" class="btn btn-neutral" title="11. Input / Output / Computing utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Suhas Somnath, Chris R. Smith, Stephen Jesse.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.4',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>