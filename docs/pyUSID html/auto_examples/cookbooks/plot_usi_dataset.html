

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>02. The USIDataset &mdash; pyUSID 0.0.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="03. Translation and the NumpyTranslator" href="plot_numpy_translator.html" />
    <link rel="prev" title="01. Primer to HDF5 and h5py" href="plot_h5py.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pyUSID
          

          
          </a>

          
            
            
              <div class="version">
                0.0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">pyUSID</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../external_guides.html">Tutorials on Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package_organization.html">Package Organization</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples &amp; Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#guides-to-pyusid">Guides to pyUSID</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_h5py.html">01. Primer to HDF5 and h5py</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">02. The USIDataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usid-main-datasets">USID Main Datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usidatasets-usid-main-datasets">USIDatasets = USID Main Datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recommended-pre-requisite-reading">Recommended pre-requisite reading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-scientific-dataset">Example scientific dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-all-necessary-packages">Load all necessary packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-the-dataset">Load the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-usidataset">Creating a USIDataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#easier-access-to-information">Easier access to information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#values-for-each-dimension">Values for each Dimension</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reshaping-to-n-dimensions">Reshaping to N dimensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#slicing">Slicing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interactive-visualization">Interactive Visualization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_numpy_translator.html">03. Translation and the NumpyTranslator</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_plot_utils.html">04. Plotting utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_hdf_utils_read.html">05. Utilities for reading h5USID files</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_dtype_utils.html">06. Utilities for handling data types and transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_parallel_compute.html">07. Speed up computations with parallel_compute()</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_write_utils.html">08. Utilities that assist in writing USID data</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_hdf_utils_write.html">09. Utilities for writing h5USID files</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_process.html">10. Formalizing Data Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_io_utils.html">11. Input / Output / Computing utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data_format.html">Data Model and File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution_guidelines.html">Guidelines for Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What’s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../matlab_to_python.html">Upgrading from Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyUSID</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples &amp; Tutorials</a> &raquo;</li>
        
      <li>02. The USIDataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/auto_examples/cookbooks/plot_usi_dataset.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-cookbooks-plot-usi-dataset-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="the-usidataset">
<span id="sphx-glr-auto-examples-cookbooks-plot-usi-dataset-py"></span><h1>02. The USIDataset<a class="headerlink" href="#the-usidataset" title="Permalink to this headline">¶</a></h1>
<p><strong>Suhas Somnath</strong></p>
<p>11/11/2017</p>
<p><strong>This document illustrates how the pyUSID.USIDataset class substantially simplifies accessing information about,
slicing, and visualizing N-dimensional Universal Spectroscopy and Imaging Data (USID) Main datasets</strong></p>
<div class="section" id="usid-main-datasets">
<h2>USID Main Datasets<a class="headerlink" href="#usid-main-datasets" title="Permalink to this headline">¶</a></h2>
<p>According to the <strong>Universal Spectroscopy and Imaging Data (USID)</strong> model, all spatial dimensions are collapsed to a
single dimension and, similarly, all spectroscopic dimensions
are also collapsed to a single dimension. Thus, the data is stored as a two-dimensional (N x P) matrix with N spatial
locations each with P spectroscopic data points.</p>
<p>This general and intuitive format allows imaging data from any instrument, measurement scheme, size, or dimensionality
to be represented in the same way. Such an instrument independent data format enables a single set of analysis and
processing functions to be reused for multiple image formats or modalities.</p>
<p><code class="docutils literal notranslate"><span class="pre">Main</span> <span class="pre">datasets</span></code> are greater than the sum of their parts. They are more capable and information-packed than
conventional datasets since they have (or are linked to) all the necessary information to describe a measured dataset.
The additional information contained / linked by <code class="docutils literal notranslate"><span class="pre">Main</span> <span class="pre">datasets</span></code> includes:</p>
<ul class="simple">
<li>the recorded physical quantity</li>
<li>units of the data</li>
<li>names of the position and spectroscopic dimensions</li>
<li>dimensionality of the data in its original N dimensional form etc.</li>
</ul>
</div>
<div class="section" id="usidatasets-usid-main-datasets">
<h2>USIDatasets = USID Main Datasets<a class="headerlink" href="#usidatasets-usid-main-datasets" title="Permalink to this headline">¶</a></h2>
<p>Regardless, <code class="docutils literal notranslate"><span class="pre">Main</span> <span class="pre">datasets</span></code> are just concepts or blueprints and not concrete digital objects in a programming language
or a file. <code class="docutils literal notranslate"><span class="pre">USIDatasets</span></code> are <strong>tangible representations of Main datasets</strong>. From an implementation perspective, the
USIDataset class extends the <code class="docutils literal notranslate"><span class="pre">h5py.Dataset</span> <span class="pre">object</span></code>. In other words, USIDatasets have all the capabilities of
standard HDF5 / h5py Dataset objects but are supercharged from a scientific perspective since they:</p>
<ul class="simple">
<li>are self-describing</li>
<li>allow quick interactive visualization in Jupyter notebooks</li>
<li>allow intuitive slicing of the N dimensional dataset</li>
<li>and much much more.</li>
</ul>
<p>While it is most certainly possible to access this information and enable these functionalities via the native <code class="docutils literal notranslate"><span class="pre">h5py</span></code>
functionality, it can become tedious very quickly.  In fact, a lot of the functionality of USIDataset comes from
orchestration of multiple functions in <code class="docutils literal notranslate"><span class="pre">pyUSID.hdf_utils</span></code> outlined in other documents. The USIDataset class
makes such necessary information and functionality easily accessible.</p>
<p>Since Main datasets are the hubs of information in a USID HDF5 file (<strong>h5USID</strong>), we expect that the majority of
the data interrogation will happen via USIDatasets</p>
</div>
<div class="section" id="recommended-pre-requisite-reading">
<h2>Recommended pre-requisite reading<a class="headerlink" href="#recommended-pre-requisite-reading" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="/../../data_format.html">USID data model</a></li>
<li><a class="reference external" href="./plot_h5py.html">Crash course on HDF5 and h5py</a></li>
<li>Utilities for <a class="reference external" href="./plot_hdf_utils_read.html">reading</a> and <a class="reference external" href="./plot_hdf_utils_write.html">writing</a>
h5USID files using pyUSID</li>
</ul>
</div>
<div class="section" id="example-scientific-dataset">
<h2>Example scientific dataset<a class="headerlink" href="#example-scientific-dataset" title="Permalink to this headline">¶</a></h2>
<p>Before, we dive into the functionalities of USIDatasets we need to understand the dataset that will be used in this
example. For this example, we will be working with a Band Excitation Polarization Switching (BEPS) dataset acquired
from advanced atomic force microscopes. In the much simpler Band Excitation (BE) imaging datasets, a single spectra
is acquired at each location in a two dimensional grid of spatial locations. Thus, BE imaging datasets have two
position dimensions (X, Y) and one spectroscopic dimension (frequency - against which the spectra is recorded). The
BEPS dataset used in this example has a spectra for each combination of three other parameters (DC offset, Field, and
Cycle). Thus, this dataset has three new spectral dimensions in addition to the spectra itself. Hence, this dataset
becomes a 2+4 = 6 dimensional dataset</p>
</div>
<div class="section" id="load-all-necessary-packages">
<h2>Load all necessary packages<a class="headerlink" href="#load-all-necessary-packages" title="Permalink to this headline">¶</a></h2>
<p>First, we need to load the necessary packages. Here are a list of packages, besides pyUSID, that will be used in
this example:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">h5py</span></code> - to open and close the file</li>
<li><code class="docutils literal notranslate"><span class="pre">wget</span></code> - to download the example data file</li>
<li><code class="docutils literal notranslate"><span class="pre">numpy</span></code> - for numerical operations on arrays in memory</li>
<li><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> - basic visualization of data</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">unicode_literals</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># Warning package in case something goes wrong</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="n">package</span><span class="p">])</span>
<span class="c1"># Package for downloading online files:</span>


<span class="k">try</span><span class="p">:</span>
    <span class="c1"># This package is not part of anaconda and may need to be installed.</span>
    <span class="kn">import</span> <span class="nn">wget</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;wget not found.  Will install with pip.&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pip</span>
    <span class="n">install</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">wget</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pyUSID</span> <span class="kn">as</span> <span class="nn">usid</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;pyUSID not found.  Will install with pip.&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pip</span>
    <span class="n">install</span><span class="p">(</span><span class="s1">&#39;pyUSID&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pyUSID</span> <span class="kn">as</span> <span class="nn">usid</span>
</pre></div>
</div>
</div>
<div class="section" id="load-the-dataset">
<h2>Load the dataset<a class="headerlink" href="#load-the-dataset" title="Permalink to this headline">¶</a></h2>
<p>First, lets download example h5USID file from the pyUSID Github project:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pycroscopy/pyUSID/master/data/BEPS_small.h5&#39;</span>
<span class="n">h5_path</span> <span class="o">=</span> <span class="s1">&#39;temp.h5&#39;</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">h5_path</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Working on:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">h5_path</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Working on:
temp.h5
</pre></div>
</div>
<p>Next, lets open this HDF5 file in read-only mode. Note that opening the file does not cause the contents to be
automatically loaded to memory. Instead, we are presented with objects that refer to specific HDF5 datasets,
attributes or groups in the file</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h5_path</span> <span class="o">=</span> <span class="s1">&#39;temp.h5&#39;</span>
<span class="n">h5_f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">h5_f</span></code> is an active handle to the open file.
Lets quickly look at the contents of this HDF5 file using a handy function in <code class="docutils literal notranslate"><span class="pre">pyUSID.hdf_utils</span></code> - <code class="docutils literal notranslate"><span class="pre">print_tree()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Contents of the H5 file:&#39;</span><span class="p">)</span>
<span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">h5_f</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Contents of the H5 file:
/
├ Measurement_000
  ---------------
  ├ Channel_000
    -----------
    ├ Bin_FFT
    ├ Bin_Frequencies
    ├ Bin_Indices
    ├ Bin_Step
    ├ Bin_Wfm_Type
    ├ Excitation_Waveform
    ├ Noise_Floor
    ├ Position_Indices
    ├ Position_Values
    ├ Raw_Data
    ├ Raw_Data-SHO_Fit_000
      --------------------
      ├ Fit
      ├ Guess
      ├ Spectroscopic_Indices
      ├ Spectroscopic_Values
    ├ Spatially_Averaged_Plot_Group_000
      ---------------------------------
      ├ Bin_Frequencies
      ├ Mean_Spectrogram
      ├ Spectroscopic_Parameter
      ├ Step_Averaged_Response
    ├ Spatially_Averaged_Plot_Group_001
      ---------------------------------
      ├ Bin_Frequencies
      ├ Mean_Spectrogram
      ├ Spectroscopic_Parameter
      ├ Step_Averaged_Response
    ├ Spectroscopic_Indices
    ├ Spectroscopic_Values
    ├ UDVS
    ├ UDVS_Indices
</pre></div>
</div>
<p>For this example, we will only focus on the <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code> dataset which contains the 6D raw measurement data. First lets
access the HDF5 dataset and check if it is a <code class="docutils literal notranslate"><span class="pre">Main</span></code> dataset in the first place:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h5_raw</span> <span class="o">=</span> <span class="n">h5_f</span><span class="p">[</span><span class="s1">&#39;/Measurement_000/Channel_000/Raw_Data&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">h5_raw</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;h5_raw is a main dataset? {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">check_if_main</span><span class="p">(</span><span class="n">h5_raw</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;HDF5 dataset &quot;Raw_Data&quot;: shape (25, 22272), type &quot;&lt;c8&quot;&gt;
h5_raw is a main dataset? True
</pre></div>
</div>
<p>It turns out that this is indeed a Main dataset. Therefore, we can turn this in to a USIDataset without any
problems.</p>
</div>
<div class="section" id="creating-a-usidataset">
<h2>Creating a USIDataset<a class="headerlink" href="#creating-a-usidataset" title="Permalink to this headline">¶</a></h2>
<p>All one needs for creating a USIDataset object is a Main dataset. Here is how we can supercharge h5_raw:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd_raw</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">USIDataset</span><span class="p">(</span><span class="n">h5_raw</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd_raw</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;HDF5 dataset &quot;Raw_Data&quot;: shape (25, 22272), type &quot;&lt;c8&quot;&gt;
located at:
        /Measurement_000/Channel_000/Raw_Data
Data contains:
        Cantilever Vertical Deflection (V)
Data dimensions and original shape:
Position Dimensions:
        X - size: 5
        Y - size: 5
Spectroscopic Dimensions:
        Frequency - size: 87
        DC_Offset - size: 64
        Field - size: 2
        Cycle - size: 2
Data Type:
        complex64
</pre></div>
</div>
<p>Notice how easy it was to create a USIDataset object. Also, note how the USIDataset is much more informative in
comparison with the conventional h5py.Dataset object.</p>
<div class="section" id="usidataset-supercharged-h5py-dataset">
<h3>USIDataset = Supercharged(h5py.Dataset)<a class="headerlink" href="#usidataset-supercharged-h5py-dataset" title="Permalink to this headline">¶</a></h3>
<p>Remember that USIDataset is just an extension of the h5py.Dataset object class. Therefore, both the <code class="docutils literal notranslate"><span class="pre">h5_raw</span></code> and
<code class="docutils literal notranslate"><span class="pre">pd_raw</span></code> refer to the same object as the following equality test demonstrates. Except <code class="docutils literal notranslate"><span class="pre">pd_raw</span></code> knows about the
<code class="docutils literal notranslate"><span class="pre">ancillary</span> <span class="pre">datasets</span></code> and other information which makes it a far more powerful object for you.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">pd_raw</span> <span class="o">==</span> <span class="n">h5_raw</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="section" id="easier-access-to-information">
<h2>Easier access to information<a class="headerlink" href="#easier-access-to-information" title="Permalink to this headline">¶</a></h2>
<p>Since the USIDataset is aware and has handles to the supporting ancillary datasets, they can be accessed as
properties of the object unlike HDF5 datasets. Note that these ancillary datasets can be accessed using functionality
in pyUSID.hdf_utils as well. However, the USIDataset option is far easier.</p>
<p>Let us compare accessing the Spectroscopic Indices via the USIDataset and hdf_utils functionality:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h5_spec_inds_1</span> <span class="o">=</span> <span class="n">pd_raw</span><span class="o">.</span><span class="n">h5_spec_inds</span>
<span class="n">h5_spec_inds_2</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">get_auxiliary_datasets</span><span class="p">(</span><span class="n">h5_raw</span><span class="p">,</span> <span class="s1">&#39;Spectroscopic_Indices&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">h5_spec_inds_1</span> <span class="o">==</span> <span class="n">h5_spec_inds_2</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
<p>In the same vein, it is also easy to access <strong>string descriptors</strong> of the ancillary datasets and the Main dataset.
The <code class="docutils literal notranslate"><span class="pre">hdf_utils</span></code> alternatives to these operations / properties also exist and are discussed in an alternate document,
but will not be discussed here for brevity.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Desctiption of physical quantity in the Main dataset:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd_raw</span><span class="o">.</span><span class="n">data_descriptor</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Position Dimension names and sizes:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pd_raw</span><span class="o">.</span><span class="n">pos_dim_labels</span><span class="p">,</span> <span class="n">pd_raw</span><span class="o">.</span><span class="n">pos_dim_sizes</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} : {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Spectroscopic Dimension names and sizes:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pd_raw</span><span class="o">.</span><span class="n">spec_dim_labels</span><span class="p">,</span> <span class="n">pd_raw</span><span class="o">.</span><span class="n">spec_dim_sizes</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} : {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Position Dimensions:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd_raw</span><span class="o">.</span><span class="n">pos_dim_descriptors</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Spectroscopic Dimensions:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd_raw</span><span class="o">.</span><span class="n">spec_dim_descriptors</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Desctiption of physical quantity in the Main dataset:
Cantilever Vertical Deflection (V)
Position Dimension names and sizes:
X : 5
Y : 5
Spectroscopic Dimension names and sizes:
Frequency : 87
DC_Offset : 64
Field : 2
Cycle : 2
Position Dimensions:
[&#39;X (m)&#39;, &#39;Y (m)&#39;]
Spectroscopic Dimensions:
[&#39;Frequency (Hz)&#39;, &#39;DC_Offset (V)&#39;, &#39;Field ()&#39;, &#39;Cycle ()&#39;]
</pre></div>
</div>
</div>
<div class="section" id="values-for-each-dimension">
<h2>Values for each Dimension<a class="headerlink" href="#values-for-each-dimension" title="Permalink to this headline">¶</a></h2>
<p>When visualizing the data it is essential to plot the data against appropriate values on the X, Y, Z axes. The
USIDataset object makes it very easy to access the values over which a dimension was varied using the
<code class="docutils literal notranslate"><span class="pre">get_pos_values()</span></code> and <code class="docutils literal notranslate"><span class="pre">get_spec_values()</span></code> functions. This functionality is enabled by the <code class="docutils literal notranslate"><span class="pre">get_unit_values()</span></code>
function in <code class="docutils literal notranslate"><span class="pre">pyUSID.hdf_utils</span></code>.</p>
<p>For example, let us say we wanted to see how the <code class="docutils literal notranslate"><span class="pre">DC_Offset</span></code> dimension was varied, we could:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dim_name</span> <span class="o">=</span> <span class="s1">&#39;DC_Offset&#39;</span>
<span class="n">dc_vec</span> <span class="o">=</span> <span class="n">pd_raw</span><span class="o">.</span><span class="n">get_spec_values</span><span class="p">(</span><span class="n">dim_name</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dc_vec</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Points in dimension&#39;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">dim_name</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_usi_dataset_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_usi_dataset_001.png" />
</div>
<div class="section" id="reshaping-to-n-dimensions">
<h2>Reshaping to N dimensions<a class="headerlink" href="#reshaping-to-n-dimensions" title="Permalink to this headline">¶</a></h2>
<p>The USID model stores N dimensional datasets in a flattened 2D form of position x spectral values. It can become
challenging to retrieve the data in its original N-dimensional form, especially for multidimensional datasets
such as the one we are working on. Fortunately, all the information regarding the dimensionality of the dataset
are contained in the spectral and position ancillary datasets. PycoDataset makes it remarkably easy to obtain the N
dimensional form of a dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndim_form</span> <span class="o">=</span> <span class="n">pd_raw</span><span class="o">.</span><span class="n">get_n_dim_form</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Shape of the N dimensional form of the dataset:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ndim_form</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;And these are the dimensions&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd_raw</span><span class="o">.</span><span class="n">n_dim_labels</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Shape of the N dimensional form of the dataset:
(5, 5, 87, 64, 2, 2)
And these are the dimensions
[&#39;X&#39;, &#39;Y&#39;, &#39;Frequency&#39;, &#39;DC_Offset&#39;, &#39;Field&#39;, &#39;Cycle&#39;]
</pre></div>
</div>
</div>
<div class="section" id="slicing">
<h2>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">¶</a></h2>
<p>It is often very challenging to grapple with multidimensional datasets such as the one in this example. It may not
even be possible to load the entire dataset in its 2D or N dimensional form to memory if the dataset is several (or
several hundred) gigabytes large. Slicing the 2D Main dataset can easily become confusing and frustrating. To solve
this problem, USIDataset has a <code class="docutils literal notranslate"><span class="pre">slice()</span></code> function that efficiently loads the only the sliced data into memory and
reshapes the data to an N dimensional form. Best of all, the slicing arguments can be provided in the actual
N dimensional form!</p>
<p>For example, imagine that we cannot load the entire example dataset in its N dimensional form and then slice it. Lets
try to get the spatial map for the following conditions without loading the entire dataset in its N dimensional form
and then slicing it :</p>
<ul class="simple">
<li>14th index of DC Offset</li>
<li>1st index of cycle</li>
<li>0th index of Field (remember Python is 0 based)</li>
<li>43rd index of Frequency</li>
</ul>
<p>To get this, we would slice as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spat_map_1</span><span class="p">,</span> <span class="n">success</span> <span class="o">=</span> <span class="n">pd_raw</span><span class="o">.</span><span class="n">slice</span><span class="p">({</span><span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;DC_Offset&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;Field&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cycle&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>As a verification, lets try to plot the same spatial map by slicing the N dimensional form we got earlier and compare
it with what we got above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spat_map_2</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.squeeze.html#numpy.squeeze" title="View documentation for numpy.squeeze"><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span></a><span class="p">(</span><span class="n">ndim_form</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;2D slicing == ND slicing: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html#numpy.allclose" title="View documentation for numpy.allclose"><span class="n">np</span><span class="o">.</span><span class="n">allclose</span></a><span class="p">(</span><span class="n">spat_map_1</span><span class="p">,</span> <span class="n">spat_map_2</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2D slicing == ND slicing: True
</pre></div>
</div>
</div>
<div class="section" id="interactive-visualization">
<h2>Interactive Visualization<a class="headerlink" href="#interactive-visualization" title="Permalink to this headline">¶</a></h2>
<p>USIDatasets also enable quick, interactive, and easy visualization of data up to 2 position and 2 spectroscopic
dimensions (4D datasets). Since this particular example has 6 dimensions, we would need to slice two dimensions in
order to visualize the remaining 4 dimensions. Note that this interactive visualization ONLY works on Jupyter
Notebooks. This html file generated by a python script does not allow for interactive visualization and you may only
see a set of static plots. We encourage you to click on the
<a class="reference external" href="https://pycroscopy.github.io/pyUSID/_downloads/plot_usi_dataset.ipynb">Download as Jupyter Notebook</a> button
below to try it out yourself.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd_raw</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">slice_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Field&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cycle&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">});</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_usi_dataset_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_usi_dataset_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>interactive(children=(IntSlider(value=2, description=&#39;X&#39;, max=4), IntSlider(value=2, description=&#39;Y&#39;, max=4), IntSlider(value=43, description=&#39;Frequency&#39;, max=86), IntSlider(value=31, description=&#39;DC_Offset&#39;, max=63), Dropdown(description=&#39;component&#39;, options=(&#39;Real&#39;, &#39;Imaginary&#39;, &#39;Amplitude&#39;, &#39;Phase&#39;), value=&#39;Real&#39;), Output()), _dom_classes=(&#39;widget-interact&#39;,))
</pre></div>
</div>
<p>Close and delete the h5_file</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h5_f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">h5_path</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  1.123 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-cookbooks-plot-usi-dataset-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_usi_dataset.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_usi_dataset.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_usi_dataset.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_usi_dataset.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_numpy_translator.html" class="btn btn-neutral float-right" title="03. Translation and the NumpyTranslator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_h5py.html" class="btn btn-neutral" title="01. Primer to HDF5 and h5py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Suhas Somnath, Chris R. Smith, Stephen Jesse.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.0.4',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>