

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyUSID.viz.plot_utils &mdash; pyUSID 0.0.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> pyUSID
          

          
          </a>

          
            
            
              <div class="version">
                0.0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">pyUSID</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../external_guides.html">Tutorials on Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package_organization.html">Package Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html">Examples &amp; Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_format.html">Data Model and File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribution_guidelines.html">Guidelines for Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whats_new.html">Whatâ€™s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../matlab_to_python.html">Upgrading from Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyUSID</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyUSID.viz.plot_utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyUSID.viz.plot_utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu May 05 13:29:12 2016</span>

<span class="sd">@author: Suhas Somnath, Chris R. Smith</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># TODO: All general plotting functions should support data with 1, 2, or 3 spatial dimensions.</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>

<span class="n">default_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span>


<div class="viewcode-block" id="reset_plot_params"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.reset_plot_params">[docs]</a><span class="k">def</span> <span class="nf">reset_plot_params</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resets the plot parameters to matplotlib default values</span>
<span class="sd">    Adapted from:</span>
<span class="sd">    https://stackoverflow.com/questions/26413185/how-to-recover-matplotlib-defaults-after-setting-stylesheet</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># Also resetting ipython inline parameters</span>
    <span class="n">inline_rc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inline_rc</span><span class="p">)</span></div>


<div class="viewcode-block" id="use_nice_plot_params"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.use_nice_plot_params">[docs]</a><span class="k">def</span> <span class="nf">use_nice_plot_params</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resets default plot parameters such as figure size, font sizes etc. to values better suited for scientific</span>
<span class="sd">    publications</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># mpl.rcParams.keys()  # gets all allowable keys</span>
    <span class="c1"># mpl.rc(&#39;figure&#39;, figsize=(5.5, 5))</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># global font size</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick.major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick.minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div>
    <span class="c1"># mpl.rcParams[&#39;xtick.major.size&#39;] = 6</span>


<div class="viewcode-block" id="get_plot_grid_size"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.get_plot_grid_size">[docs]</a><span class="k">def</span> <span class="nf">get_plot_grid_size</span><span class="p">(</span><span class="n">num_plots</span><span class="p">,</span> <span class="n">fewer_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of rows and columns ideal for visualizing multiple (identical) plots within a single figure</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_plots : uint</span>
<span class="sd">        Number of identical subplots within a figure</span>
<span class="sd">    fewer_rows : bool, optional. Default = True</span>
<span class="sd">        Set to True if the grid should be short and wide or False for tall and narrow</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nrows : uint</span>
<span class="sd">        Number of rows</span>
<span class="sd">    ncols : uint</span>
<span class="sd">        Number of columns</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_plots</span><span class="p">,</span> <span class="n">Number</span><span class="p">),</span> <span class="s1">&#39;num_plots must be a number&#39;</span>
    <span class="c1"># force integer:</span>
    <span class="n">num_plots</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_plots</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_plots</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;num_plots was less than 0&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fewer_rows</span><span class="p">:</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_plots</span><span class="p">)))</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_plots</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_plots</span><span class="p">)))</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_plots</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span></div>


<div class="viewcode-block" id="set_tick_font_size"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.set_tick_font_size">[docs]</a><span class="k">def</span> <span class="nf">set_tick_font_size</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">font_size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the font size of the ticks in the provided axes</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axes : matplotlib.pyplot.axis object or list of axis objects</span>
<span class="sd">        axes to set font sizes</span>
<span class="sd">    font_size : unigned int</span>
<span class="sd">        Font size</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font_size</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span>
    <span class="n">font_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">font_size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__set_axis_tick</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the font sizes to the x and y axis in the given axis object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : matplotlib.axes.Axes object</span>
<span class="sd">            axis to set font sizes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>

    <span class="n">mesg</span> <span class="o">=</span> <span class="s1">&#39;axes must either be a matplotlib.axes.Axes object or an iterable containing such objects&#39;</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">),</span> <span class="n">mesg</span>
            <span class="n">__set_axis_tick</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">),</span> <span class="n">mesg</span>
        <span class="n">__set_axis_tick</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_scalar_mappable"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.make_scalar_mappable">[docs]</a><span class="k">def</span> <span class="nf">make_scalar_mappable</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a scalar mappable object that can be used to create a colorbar for non-image (e.g. - line) plots</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vmin : Number</span>
<span class="sd">        Minimum value for colorbar</span>
<span class="sd">    vmax : Number</span>
<span class="sd">        Maximum value for colorbar</span>
<span class="sd">    cmap : colormap object</span>
<span class="sd">        Colormap object to use</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sm : matplotlib.pyplot.cm.ScalarMappable object</span>
<span class="sd">        The object that can used to create a colorbar via plt.colorbar(sm)</span>

<span class="sd">    Adapted from: https://stackoverflow.com/questions/8342549/matplotlib-add-colorbar-to-a-sequence-of-line-plots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">Number</span><span class="p">),</span> <span class="s1">&#39;vmin should be a number&#39;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span> <span class="n">Number</span><span class="p">),</span> <span class="s1">&#39;vmax should be a number&#39;</span>
    <span class="k">assert</span> <span class="n">vmin</span> <span class="o">&lt;</span> <span class="n">vmax</span><span class="p">,</span> <span class="s1">&#39;vmin must be less than vmax&#39;</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">default_cmap</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Colormap</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">))</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                               <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">))</span>
    <span class="c1"># fake up the array of the scalar mappable</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="n">sm</span></div>


<div class="viewcode-block" id="cbar_for_line_plot"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.cbar_for_line_plot">[docs]</a><span class="k">def</span> <span class="nf">cbar_for_line_plot</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">,</span> <span class="n">discrete_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a colorbar next to a line plot axis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : matplotlib.axes.Axes</span>
<span class="sd">        Axis with multiple line objects</span>
<span class="sd">    num_steps : uint</span>
<span class="sd">        Number of steps in the colorbar</span>
<span class="sd">    discrete_ticks : (optional) bool</span>
<span class="sd">        Whether or not to have the ticks match the number of number of steps. Default = True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;axis must be a matplotlib.axes.Axes object&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">num_steps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;num_steps must be a whole number&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_ticks</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">discrete_cmap</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">discrete_ticks</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;ticks&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_steps</span><span class="p">)})</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                        <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cbar</span></div>


<div class="viewcode-block" id="get_cmap_object"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.get_cmap_object">[docs]</a><span class="k">def</span> <span class="nf">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the matplotlib.colors.LinearSegmentedColormap object regardless of the input</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cmap : String, or matplotlib.colors.LinearSegmentedColormap object (Optional)</span>
<span class="sd">        Requested color map</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Requested / Default colormap object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">default_cmap</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Colormap</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cmap should either be a matplotlib.colors.Colormap object or a string&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cmap</span></div>


<div class="viewcode-block" id="cmap_jet_white_center"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.cmap_jet_white_center">[docs]</a><span class="k">def</span> <span class="nf">cmap_jet_white_center</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the jet colormap with a white center</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    white_jet : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        color map object that can be used in place of the default colormap</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For red - central column is like brightness</span>
    <span class="c1"># For blue - last column is like brightness</span>
    <span class="n">cdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
             <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.42</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.58</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
             <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
             <span class="p">}</span>
    <span class="k">return</span> <span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="s1">&#39;white_jet&#39;</span><span class="p">,</span> <span class="n">cdict</span><span class="p">)</span></div>


<div class="viewcode-block" id="cmap_from_rgba"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.cmap_from_rgba">[docs]</a><span class="k">def</span> <span class="nf">cmap_from_rgba</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">interp_vals</span><span class="p">,</span> <span class="n">normalization_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a colormap given a matlab-style interpolation table</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : String / Unicode</span>
<span class="sd">        Name of the desired colormap</span>
<span class="sd">    interp_vals : List of tuples</span>
<span class="sd">        Interpolation table that describes the desired color map. Each entry in the table should be described as:</span>
<span class="sd">        (position in the colorbar, (red, green, blue, alpha))</span>
<span class="sd">        The position in the color bar, red, green, blue, and alpha vary from 0 to the normalization value</span>
<span class="sd">    normalization_val : number</span>
<span class="sd">        The common maximum value for the position in the color bar, red, green, blue, and alpha</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        desired color map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;name should be a string&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;interp_vals must be a list of tuples&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization_val</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;normalization_val must be a number&#39;</span><span class="p">)</span>

    <span class="n">normalization_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">normalization_val</span><span class="p">)</span>

    <span class="n">cdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                           <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
             <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                             <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
             <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                            <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
             <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                             <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])}</span>

    <span class="k">return</span> <span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cdict</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_linear_alpha_cmap"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.make_linear_alpha_cmap">[docs]</a><span class="k">def</span> <span class="nf">make_linear_alpha_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">solid_color</span><span class="p">,</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">min_alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a transparent to opaque color map based on a single solid color</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : String / Unicode</span>
<span class="sd">        Name of the desired colormap</span>
<span class="sd">    solid_color : List of numbers</span>
<span class="sd">        red, green, blue, and alpha values for a specific color</span>
<span class="sd">    normalization_val : number</span>
<span class="sd">        The common maximum value for the red, green, blue, and alpha values. This is 1 in matplotlib</span>
<span class="sd">    min_alpha : float (optional. Default = 0 : ie- transparent)</span>
<span class="sd">        Lowest alpha value for the bottom of the color bar</span>
<span class="sd">    max_alpha : float (optional. Default = 1 : ie- opaque)</span>
<span class="sd">        Highest alpha value for the top of the color bar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        transparent to opaque color map based on the provided color</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;name should be a string&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solid_color</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;solid_color must be a list of numbers&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">solid_color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;solid-color should have fourth values&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">solid_color</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;solid_color should have three numbers for red, green, blue&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization_val</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;normalization_val must be a number&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">min_alpha</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;min_alpha should be a Number&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_alpha</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;max_alpha should be a Number&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_alpha</span> <span class="o">&gt;=</span> <span class="n">max_alpha</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;min_alpha must be less than max_alpha&#39;</span><span class="p">)</span>

    <span class="n">solid_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solid_color</span><span class="p">)</span> <span class="o">/</span> <span class="n">normalization_val</span> <span class="o">*</span> <span class="mf">1.0</span>
    <span class="n">interp_table</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">solid_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">max_alpha</span><span class="p">)),</span>
                    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">solid_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">min_alpha</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">cmap_from_rgba</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">interp_table</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="cmap_hot_desaturated"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.cmap_hot_desaturated">[docs]</a><span class="k">def</span> <span class="nf">cmap_hot_desaturated</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a desaturated color map based on the hot colormap</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Desaturated version of the hot color map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hot_desaturated</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">255.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">218.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">107</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">182.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">145.6</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">109.4</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">72.675</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">36.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">71</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">255</span><span class="p">))]</span>

    <span class="k">return</span> <span class="n">cmap_from_rgba</span><span class="p">(</span><span class="s1">&#39;hot_desaturated&#39;</span><span class="p">,</span> <span class="n">hot_desaturated</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span></div>


<div class="viewcode-block" id="discrete_cmap"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.discrete_cmap">[docs]</a><span class="k">def</span> <span class="nf">discrete_cmap</span><span class="p">(</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an N-bin discrete colormap from the specified input map specified</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_bins : unsigned int</span>
<span class="sd">        Number of discrete bins</span>
<span class="sd">    cmap : matplotlib.colors.Colormap object</span>
<span class="sd">        Base color map to discretize</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Discretized color map</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Jake VanderPlas License: BSD-style</span>
<span class="sd">    https://gist.github.com/jakevdp/91077b0cae40f8f8244a</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">default_cmap</span><span class="o">.</span><span class="n">name</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Colormap</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">name</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cmap should be a string or a matplotlib.colors.Colormap object&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)</span></div>


<div class="viewcode-block" id="rainbow_plot"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.rainbow_plot">[docs]</a><span class="k">def</span> <span class="nf">rainbow_plot</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">x_vec</span><span class="p">,</span> <span class="n">y_vec</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the input against the output vector such that the color of the curve changes as a function of index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : matplotlib.axes.Axes object</span>
<span class="sd">        Axis to plot the curve</span>
<span class="sd">    x_vec : 1D float numpy array</span>
<span class="sd">        vector that forms the X axis</span>
<span class="sd">    y_vec : 1D float numpy array</span>
<span class="sd">        vector that forms the Y axis</span>
<span class="sd">    num_steps : unsigned int (Optional)</span>
<span class="sd">        Number of discrete color steps</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;axis must be a matplotlib.axes.Axes object&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x_vec must be array-like of numbers&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x_vec must be array-like of numbers&#39;</span><span class="p">)</span>
    <span class="n">x_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span>
    <span class="n">y_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_vec</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">y_vec</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x_vec and y_vec must be 1D arrays&#39;</span>
    <span class="k">assert</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">y_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;x_vec and y_vec must have the same shape&#39;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;num_steps must be an integer &lt; size of x_vec&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_steps</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">num_steps</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;num_steps should be a positive number. 1/4 to 1/16th of x_vec&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">num_steps</span> <span class="o">&lt;</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;num_steps must be an integer &lt; size of x_vec&#39;</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">default_cmap</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c1"># Remove any color flag</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">pts_per_step</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_vec</span><span class="p">)</span> <span class="o">//</span> <span class="n">num_steps</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vec</span><span class="p">[</span><span class="n">step</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:(</span><span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">],</span>
                  <span class="n">y_vec</span><span class="p">[</span><span class="n">step</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:(</span><span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">],</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">step</span> <span class="o">//</span> <span class="n">num_steps</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># plot the remainder:</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vec</span><span class="p">[(</span><span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:],</span>
              <span class="n">y_vec</span><span class="p">[(</span><span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:],</span>
              <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">num_steps</span> <span class="o">/</span> <span class="n">num_steps</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_line_family"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.plot_line_family">[docs]</a><span class="k">def</span> <span class="nf">plot_line_family</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">x_vec</span><span class="p">,</span> <span class="n">line_family</span><span class="p">,</span> <span class="n">line_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">label_suffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="n">y_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">show_cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a family of lines with a sequence of colors</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : matplotlib.axes.Axes object</span>
<span class="sd">        Axis to plot the curve</span>
<span class="sd">    x_vec : array-like</span>
<span class="sd">        Values to plot against</span>
<span class="sd">    line_family : 2D numpy array</span>
<span class="sd">        family of curves arranged as [curve_index, features]</span>
<span class="sd">    line_names : array-like</span>
<span class="sd">        array of string or numbers that represent the identity of each curve in the family</span>
<span class="sd">    label_prefix : string / unicode</span>
<span class="sd">        prefix for the legend (before the index of the curve)</span>
<span class="sd">    label_suffix : string / unicode</span>
<span class="sd">        suffix for the legend (after the index of the curve)</span>
<span class="sd">    y_offset : (optional) number</span>
<span class="sd">        quantity by which the lines are offset from each other vertically (useful for spectra)</span>
<span class="sd">    show_cbar : (optional) bool</span>
<span class="sd">        Whether or not to show a colorbar (instead of a legend)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;axis must be a matplotlib.axes.Axes object&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x_vec must be array-like of numbers&#39;</span><span class="p">)</span>
    <span class="n">x_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x_vec must be a 1D array&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line_family</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">line_family</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">line_family</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line_family</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;line_family must be a 2d array of numbers&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">line_family</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;line_family must be a 2D array&#39;</span>
    <span class="k">assert</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">line_family</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;The size of the 2nd dimension of line_family must match with of x_vec&#39;</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="n">line_family</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">label_suffix</span><span class="p">,</span> <span class="n">label_prefix</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;label_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;label_prefix&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; needs to be a string&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;y_offset should be a Number&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_cbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line_names</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;line_names should be a list of strings&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line_names</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;line_names should be a list of strings&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_lines</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;length of line_names not matching with that of line_family&#39;</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">line_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># label_prefix = &#39;Line &#39;</span>
        <span class="n">line_names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">line_ind</span><span class="p">)</span> <span class="k">for</span> <span class="n">line_ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">)]</span>

    <span class="n">line_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label_prefix</span><span class="p">,</span> <span class="n">cur_name</span><span class="p">,</span> <span class="n">label_suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">cur_name</span> <span class="ow">in</span> <span class="n">line_names</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">line_ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">):</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="n">line_family</span><span class="p">[</span><span class="n">line_ind</span><span class="p">]</span> <span class="o">+</span> <span class="n">line_ind</span> <span class="o">*</span> <span class="n">y_offset</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="n">line_names</span><span class="p">[</span><span class="n">line_ind</span><span class="p">],</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">line_ind</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_lines</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_cbar</span><span class="p">:</span>
        <span class="c1"># put back the cmap parameter:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="n">cmap</span><span class="p">})</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">cbar_for_line_plot</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">num_lines</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_map"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.plot_map">[docs]</a><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">show_xy_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">num_ticks</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots an image within the given axis with a color bar + label and appropriate X, Y tick labels.</span>
<span class="sd">    This is particularly useful to get readily interpretable plots for papers</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : matplotlib.axes.Axes object</span>
<span class="sd">        Axis to plot this image onto</span>
<span class="sd">    img : 2D numpy array with real values</span>
<span class="sd">        Data for the image plot</span>
<span class="sd">    show_xy_ticks : bool, Optional, default = None, shown unedited</span>
<span class="sd">        Whether or not to show X, Y ticks</span>
<span class="sd">    show_cbar : bool, optional, default = True</span>
<span class="sd">        Whether or not to show the colorbar</span>
<span class="sd">    x_vec : 1-D array-like or Number, optional</span>
<span class="sd">        if an array-like is provided, these will be used for the tick values on the X axis</span>
<span class="sd">        if a Number is provided, this will serve as an extent for tick values in the X axis.</span>
<span class="sd">        For example x_vec=1.5 would cause the x tick labels to range from 0 to 1.5</span>
<span class="sd">    y_vec : 1-D array-like or Number, optional</span>
<span class="sd">        if an array-like is provided - these will be used for the tick values on the Y axis</span>
<span class="sd">        if a Number is provided, this will serve as an extent for tick values in the Y axis.</span>
<span class="sd">        For example y_vec=225 would cause the y tick labels to range from 0 to 225</span>
<span class="sd">    num_ticks : unsigned int, optional, default = 4</span>
<span class="sd">        Number of tick marks on the X and Y axes</span>
<span class="sd">    stdevs : unsigned int (Optional. Default = None)</span>
<span class="sd">        Number of standard deviations to consider for plotting.  If None, full range is plotted.</span>
<span class="sd">    cbar_label : str, optional, default = None</span>
<span class="sd">        Labels for the colorbar. Use this for something like quantity (units)</span>
<span class="sd">    tick_font_size : unsigned int, optional, default = 14</span>
<span class="sd">        Font size to apply to x, y, colorbar ticks and colorbar label</span>
<span class="sd">    kwargs : dictionary</span>
<span class="sd">        Anything else that will be passed on to imshow</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    im_handle : handle to image plot</span>
<span class="sd">        handle to image plot</span>
<span class="sd">    cbar : handle to color bar</span>
<span class="sd">        handle to color bar</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The origin of the image will be set to the lower left corner. Use the kwarg &#39;origin&#39; to change this</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;axis must be a matplotlib.axes.Axes object&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;img should be a numpy array&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">img</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;img should be a 2D array&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_xy_ticks</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;show_xy_ticks should be a boolean value&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_cbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;show_cbar should be a boolean value&#39;</span><span class="p">)</span>
    <span class="c1"># checks for x_vec and y_vec are done below</span>
    <span class="k">if</span> <span class="n">num_ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_ticks</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;num_ticks should be a whole number&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_ticks</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;num_ticks should be at least 2&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tick_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tick_font_size</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;tick_font_size must be a whole number&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tick_font_size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;tick_font_size must be a whole number&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stdevs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stdevs</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;stdevs should be a Number&#39;</span><span class="p">)</span>
        <span class="n">data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">data_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;clim&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data_mean</span> <span class="o">-</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">data_std</span><span class="p">,</span>
                                <span class="n">data_mean</span> <span class="o">+</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">data_std</span><span class="p">]})</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;origin&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;origin&#39;</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">)})</span>

    <span class="n">im_handle</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_xy_ticks</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_xy_ticks</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">x_vec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_ticks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x_vec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">x_vec</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">x_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">x_vec</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">x_ticks</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{0:.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">x_vec</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">x_ticks</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">range</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span> <span class="o">!=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">&#39;x_vec should be array-like with shape equal to the second axis of img or img_size&#39;</span><span class="p">)</span>
                <span class="n">x_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">x_ticks</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">x_ticks</span><span class="p">]</span>

        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">x_tick_labs</span><span class="p">)</span>

        <span class="n">set_tick_font_size</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>

    <span class="k">if</span> <span class="n">show_xy_ticks</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">y_vec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_ticks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_vec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_vec</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">y_vec</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">y_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">y_vec</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{0:.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">y_vec</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_vec</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">range</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_vec</span><span class="p">)</span> <span class="o">!=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y_vec should be array-like with shape equal to the first axis of img&#39;</span><span class="p">)</span>
                <span class="n">y_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_tick_labs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

        <span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y_tick_labs</span><span class="p">)</span>

        <span class="n">set_tick_font_size</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_cbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">show_cbar</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">show_cbar</span><span class="p">:</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im_handle</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                            <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># cbar = axis.cbar_axes[count].colorbar(im_handle)</span>

        <span class="k">if</span> <span class="n">cbar_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cbar_label should be a string&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">tick_font_size</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">tick_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">im_handle</span><span class="p">,</span> <span class="n">cbar</span></div>


<div class="viewcode-block" id="plot_curves"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.plot_curves">[docs]</a><span class="k">def</span> <span class="nf">plot_curves</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">line_colors</span><span class="o">=</span><span class="p">[],</span> <span class="n">dataset_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">evenly_spaced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">num_plots</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">subtitle_prefix</span><span class="o">=</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">use_rainbow_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig_title_yoffset</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">h5_pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots curves / spectras from multiple datasets from up to 25 evenly spaced positions</span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    excit_wfms : 1D numpy float array or list of same</span>
<span class="sd">        Excitation waveform in the time domain</span>
<span class="sd">    datasets : list of 2D numpy arrays or 2D hyp5.Dataset objects</span>
<span class="sd">        Datasets containing data arranged as (pixel, time)</span>
<span class="sd">    line_colors : list of strings</span>
<span class="sd">        Colors to be used for each of the datasets</span>
<span class="sd">    dataset_names : (Optional) list of strings</span>
<span class="sd">        Names of the different datasets to be compared</span>
<span class="sd">    evenly_spaced : boolean</span>
<span class="sd">        Evenly spaced positions or first N positions</span>
<span class="sd">    num_plots : unsigned int</span>
<span class="sd">        Number of plots</span>
<span class="sd">    x_label : (optional) String</span>
<span class="sd">        X Label for all plots</span>
<span class="sd">    y_label : (optional) String</span>
<span class="sd">        Y label for all plots</span>
<span class="sd">    subtitle_prefix : (optional) String</span>
<span class="sd">        prefix for title over each plot</span>
<span class="sd">    title : (optional) String</span>
<span class="sd">        Main plot title</span>
<span class="sd">    use_rainbow_plots : (optional) Boolean</span>
<span class="sd">        Plot the lines as a function of spectral index (eg. time)</span>
<span class="sd">    fig_title_yoffset : (optional) float</span>
<span class="sd">        Y offset for the figure title. Value should be around 1</span>
<span class="sd">    h5_pos : HDF5 dataset reference or 2D numpy array</span>
<span class="sd">        Dataset containing position indices</span>
<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">use_rainbow_plots</span><span class="p">,</span> <span class="n">evenly_spaced</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;use_rainbow_plots&#39;</span><span class="p">,</span> <span class="s1">&#39;evenly_spaced&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be of type: bool&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">subtitle_prefix</span><span class="p">,</span> <span class="n">title</span><span class="p">],</span>
                             <span class="p">[</span><span class="s1">&#39;x_label&#39;</span><span class="p">,</span> <span class="s1">&#39;y_label&#39;</span><span class="p">,</span> <span class="s1">&#39;subtitle_prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be of type: str&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">fig_title_yoffset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_title_yoffset</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;fig_title_yoffset should be a Number&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig_title_yoffset</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">if</span> <span class="n">h5_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h5_pos</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;h5_pos should be a h5py.Dataset object&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_plots</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">num_plots</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;num_plots should be a number&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">dim_size</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">datasets</span><span class="p">,</span> <span class="n">excit_wfms</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">,</span> <span class="s1">&#39;excit_wfms&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> should be </span><span class="si">{}</span><span class="s1">D arrays or iterables (list or tuples) of </span><span class="si">{}</span><span class="s1">D arrays&#39;</span> \
               <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">dim_size</span><span class="p">,</span> <span class="n">dim_size</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="n">dim_size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">mesg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">for</span> <span class="n">dset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">mesg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">mesg</span><span class="p">)</span>

    <span class="c1"># modes:</span>
    <span class="c1"># 0 = one excitation waveform and one dataset</span>
    <span class="c1"># 1 = one excitation waveform but many datasets</span>
    <span class="c1"># 2 = one excitation waveform for each of many dataset</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="c1"># can be numpy array or h5py.dataset</span>
        <span class="n">num_pos</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_points</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">datasets</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)):</span>
            <span class="n">excit_wfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">excit_wfms</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_points</span><span class="p">:</span>
                <span class="n">excit_wfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">num_points</span><span class="p">:</span>
                <span class="n">excit_wfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If only a single dataset is provided, excit_wfms should be a 1D array&#39;</span><span class="p">)</span>
        <span class="n">line_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
        <span class="n">dataset_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Default&#39;</span><span class="p">]</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># dataset is a list of datasets</span>
        <span class="c1"># First check if the datasets are correctly shaped:</span>
        <span class="n">num_pos_es</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">num_points_es</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;datasets can be a list of 2D h5py.Dataset or numpy array objects&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Each datset should be a 2D array&#39;</span><span class="p">)</span>
            <span class="n">num_pos_es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">num_points_es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">num_pos_es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">)</span>
        <span class="n">num_points_es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># or np.unique(num_points_es).size &gt; 1:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The first dimension of the datasets are not matching: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">))</span>
        <span class="n">num_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
            <span class="c1"># one excitation waveform per dataset but now verify each size</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">cur_ex</span><span class="p">)</span> <span class="o">==</span> <span class="n">cur_dset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">cur_ex</span><span class="p">,</span> <span class="n">cur_dset</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of points in the datasets do not match with the excitation waveforms&#39;</span><span class="p">)</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># one excitation waveform for all datasets</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Datasets don not contain the same number of points: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">))</span>
            <span class="c1"># datasets of the same size but does this match with the size of excitation waveforms:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">excit_wfms</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of points in dataset not matching with shape of excitation waveform&#39;</span><span class="p">)</span>
            <span class="n">excit_wfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">excit_wfms</span><span class="p">]</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">dataset_names</span><span class="p">,</span> <span class="n">line_colors</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;dataset_names&#39;</span><span class="p">,</span> <span class="s1">&#39;line_colors&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">var</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be a list of strings&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; is not of same length as datasets: &#39;</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">))</span>

        <span class="c1"># Next the identification of datasets:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dataset_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dataset&#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">))]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># TODO: Generate colors from a user-specified colormap or consider using line family</span>
            <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_list</span><span class="p">):</span>
                <span class="n">remaining_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">color_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line_colors</span><span class="p">]</span>
                <span class="n">line_colors</span> <span class="o">+=</span> <span class="n">remaining_colors</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_list</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Insufficient number of line colors provided&#39;</span><span class="p">)</span>

    <span class="c1"># cannot support rainbows with multiple datasets!</span>
    <span class="n">use_rainbow_plots</span> <span class="o">=</span> <span class="n">use_rainbow_plots</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># convert it to something like mode 2</span>
        <span class="n">excit_wfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">excit_wfms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">))]</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># users are not allowed to specify colors</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">num_plots</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">num_plots</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span> <span class="n">num_pos</span><span class="p">)</span>
    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="n">get_plot_grid_size</span><span class="p">(</span><span class="n">num_plots</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">evenly_spaced</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nrows</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">axes_lin</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">posn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_pos</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">use_rainbow_plots</span><span class="p">:</span>
            <span class="n">rainbow_plot</span><span class="p">(</span><span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">],</span> <span class="n">excit_wfms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">posn</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">ex_wfm</span><span class="p">,</span> <span class="n">col_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">excit_wfms</span><span class="p">,</span> <span class="n">line_colors</span><span class="p">):</span>
                <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ex_wfm</span><span class="p">,</span> <span class="n">dataset</span><span class="p">[</span><span class="n">posn</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">col_val</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">h5_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># print(&#39;Row &#39; + str(h5_pos[posn,1]) + &#39; Col &#39; + str(h5_pos[posn,0]))</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Row &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h5_pos</span><span class="p">[</span><span class="n">posn</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; Col &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h5_pos</span><span class="p">[</span><span class="n">posn</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitle_prefix</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">posn</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">%</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">:</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">fig_title_yoffset</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plot_complex_spectra"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.plot_complex_spectra">[docs]</a><span class="k">def</span> <span class="nf">plot_complex_spectra</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="n">x_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_comps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">evenly_spaced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">subtitle_prefix</span><span class="o">=</span><span class="s1">&#39;Component&#39;</span><span class="p">,</span> <span class="n">amp_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the amplitude and phase components of the provided stack of complex valued spectrograms (2D images)</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    map_stack : 2D or 3D numpy complex matrices</span>
<span class="sd">        stack of complex valued 1D spectra arranged as [component, spectra] or</span>
<span class="sd">        2D images arranged as - [component, row, col]</span>
<span class="sd">    x_vec : 1D array-like, optional, default=None</span>
<span class="sd">        If the data are spectra (1D) instead of spectrograms (2D), x_vec is the reference array against which</span>
<span class="sd">    num_comps : int</span>
<span class="sd">        Number of images to plot</span>
<span class="sd">    title : str, optional</span>
<span class="sd">        Title to plot above everything else</span>
<span class="sd">    x_label : str, optional</span>
<span class="sd">        Label for x axis</span>
<span class="sd">    y_label : str, optional</span>
<span class="sd">        Label for y axis</span>
<span class="sd">    evenly_spaced : bool, optional. Default = True</span>
<span class="sd">        If True, images will be sampled evenly over the given dataset. Else, the first num_comps images will be plotted</span>
<span class="sd">    subtitle_prefix : str, optional</span>
<span class="sd">        Prefix for the title over each image</span>
<span class="sd">    amp_units : str, optional</span>
<span class="sd">        Units for amplitude</span>
<span class="sd">    stdevs : int</span>
<span class="sd">        Number of standard deviations to consider for plotting</span>

<span class="sd">    **kwargs will be passed on either to plot_map() or pyplot.plot()</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;map_stack should be a 2/3 dimensional array arranged as [component, row, col] or &#39;</span>
                        <span class="s1">&#39;[component, spectra&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x_vec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x_vec should be a 1D array&#39;</span><span class="p">)</span>
        <span class="n">x_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x_vec should be a 1D array&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x_vec</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x_vec: </span><span class="si">{}</span><span class="s1"> should be of the same size as the second dimension of map_stack: &#39;</span>
                             <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">x_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">num_comps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_comps</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Default</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">num_comps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;num_comps should be a positive integer&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">title</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">subtitle_prefix</span><span class="p">,</span> <span class="n">amp_units</span><span class="p">],</span>
                             <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;x_label&#39;</span><span class="p">,</span> <span class="s1">&#39;y_label&#39;</span><span class="p">,</span> <span class="s1">&#39;subtitle_prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;amp_units&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be a string&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">amp_units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">amp_units</span> <span class="o">=</span> <span class="s1">&#39;a.u.&#39;</span>
    <span class="k">if</span> <span class="n">stdevs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stdevs</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="ow">or</span> <span class="n">stdevs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;stdevs should be a positive number&#39;</span><span class="p">)</span>

    <span class="n">num_comps</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">evenly_spaced</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="n">get_plot_grid_size</span><span class="p">(</span><span class="n">num_comps</span><span class="p">)</span>

    <span class="n">figsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># Individual plot size</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.025</span><span class="p">)</span>

    <span class="n">title_prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">comp_counter</span><span class="p">,</span> <span class="n">comp_pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_pos</span><span class="p">):</span>
        <span class="n">ax_ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp_counter</span> <span class="o">//</span> <span class="n">ncols</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">)</span> <span class="o">+</span> <span class="n">comp_counter</span> <span class="o">%</span> <span class="n">ncols</span>
        <span class="n">cur_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">ax_ind</span><span class="p">],</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">ax_ind</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]]</span>
        <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Amplitude (&#39;</span> <span class="o">+</span> <span class="n">amp_units</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;Phase (rad)&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">comp_name</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">std_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">cur_axes</span><span class="p">,</span> <span class="p">[</span><span class="n">stdevs</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
            <span class="n">y_vec</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">map_stack</span><span class="p">[</span><span class="n">comp_pos</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;stdevs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_val</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">y_vec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vec</span><span class="p">,</span> <span class="n">y_vec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">num_comps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">title_prefix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> - &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">subtitle_prefix</span><span class="p">,</span> <span class="n">comp_counter</span><span class="p">)</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">title_prefix</span><span class="p">,</span> <span class="n">comp_name</span><span class="p">))</span>

            <span class="n">axis</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_ind</span> <span class="o">%</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">ax_ind</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">)</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">)</span> <span class="o">==</span> <span class="n">nrows</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plot_scree"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.plot_scree">[docs]</a><span class="k">def</span> <span class="nf">plot_scree</span><span class="p">(</span><span class="n">scree</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Scree&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the scree or scree</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    scree : 1D real numpy array</span>
<span class="sd">        The scree vector from SVD</span>
<span class="sd">    title : str</span>
<span class="sd">        Figure title.  Default Scree</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scree</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">scree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scree</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">scree</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scree</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;scree must be a 1D array or Dataset&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;title must be a string&#39;</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">])</span>  <span class="c1"># left, bottom, width, height (range 0 to 1)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)})</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">)})</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scree</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scree</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Component&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Variance&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">scree</span><span class="p">))</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">scree</span><span class="p">),</span> <span class="n">top</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">scree</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s2">&quot;Scree&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span></div>


<span class="c1"># ###############################################################################</span>


<div class="viewcode-block" id="plot_map_stack"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.plot_map_stack">[docs]</a><span class="k">def</span> <span class="nf">plot_map_stack</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="n">num_comps</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color_bar_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evenly_spaced</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse_dims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">subtitle</span><span class="o">=</span><span class="s1">&#39;Component&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Map Stack&#39;</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fig_mult</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">pad_mult</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
                   <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_yoffset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the provided stack of maps</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    map_stack : 3D real numpy array</span>
<span class="sd">        structured as [component, rows, cols]</span>
<span class="sd">    num_comps : unsigned int</span>
<span class="sd">        Number of components to plot</span>
<span class="sd">    stdevs : int</span>
<span class="sd">        Number of standard deviations to consider for plotting</span>
<span class="sd">    color_bar_mode : String, Optional</span>
<span class="sd">        Options are None, single or each. Default None</span>
<span class="sd">    evenly_spaced : bool</span>
<span class="sd">        Default False</span>
<span class="sd">    reverse_dims : Boolean (Optional), default = False</span>
<span class="sd">        Set this to True to accept data structured as [rows, cols, component]</span>
<span class="sd">    subtitle : String or list of strings</span>
<span class="sd">        The titles for each of the plots.</span>
<span class="sd">        If a single string is provided, the plot titles become [&#39;title 01&#39;, title 02&#39;, ...].</span>
<span class="sd">        if a list of strings (equal to the number of components) are provided, these are used instead.</span>
<span class="sd">    title : String</span>
<span class="sd">        ###Insert description here### Default &#39;Map Stack&#39;</span>
<span class="sd">    colorbar_label : String</span>
<span class="sd">        label for colorbar. Default is an empty string.</span>
<span class="sd">    fig_mult : length 2 array_like of uints</span>
<span class="sd">        Size multipliers for the figure.  Figure size is calculated as (num_rows*`fig_mult[0]`, num_cols*`fig_mult[1]`).</span>
<span class="sd">        Default (4, 4)</span>
<span class="sd">    pad_mult : length 2 array_like of floats</span>
<span class="sd">        Multipliers for the axis padding between plots in the stack.  Padding is calculated as</span>
<span class="sd">        (pad_mult[0]*fig_mult[1], pad_mult[1]*fig_mult[0]) for the width and height padding respectively.</span>
<span class="sd">        Default (0.1, 0.07)</span>
<span class="sd">    x_label : (optional) String</span>
<span class="sd">        X Label for all plots</span>
<span class="sd">    y_label : (optional) String</span>
<span class="sd">        Y label for all plots</span>
<span class="sd">    title_yoffset : float</span>
<span class="sd">        Offset to move the figure title vertically in the figure</span>
<span class="sd">    title_size : float</span>
<span class="sd">        Size of figure title</span>
<span class="sd">    kwargs : dictionary</span>
<span class="sd">        Keyword arguments to be passed to either matplotlib.pyplot.figure, mpl_toolkits.axes_grid1.ImageGrid, or</span>
<span class="sd">        pyUSID.viz.plot_utils.plot_map.  See specific function documentation for the relavent options.</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;map_stack should be a 3 dimensional array arranged as [component, row, col]&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_comps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_comps</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Default</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">num_comps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;num_comps should be a positive integer&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">title</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="p">,</span> <span class="n">color_bar_mode</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">],</span>
                             <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;colorbar_label&#39;</span><span class="p">,</span> <span class="s1">&#39;color_bar_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;x_label&#39;</span><span class="p">,</span> <span class="s1">&#39;y_label&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be a string&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">colorbar_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colorbar_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">y_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">color_bar_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;each&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;color_bar_mode must be either None, &quot;single&quot;, or &quot;each&quot;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">stdevs</span><span class="p">,</span> <span class="n">title_yoffset</span><span class="p">,</span> <span class="n">title_size</span><span class="p">],</span>
                             <span class="p">[</span><span class="s1">&#39;stdevs&#39;</span><span class="p">,</span> <span class="s1">&#39;title_yoffset&#39;</span><span class="p">,</span> <span class="s1">&#39;title_size&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; of value: </span><span class="si">{}</span><span class="s1"> should be a number &gt; 0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">evenly_spaced</span><span class="p">,</span> <span class="n">reverse_dims</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;evenly_spaced&#39;</span><span class="p">,</span> <span class="s1">&#39;reverse_dims&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be a bool&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">fig_mult</span><span class="p">,</span> <span class="n">pad_mult</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;fig_mult&#39;</span><span class="p">,</span> <span class="s1">&#39;pad_mult&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should be a tuple / list / numpy array of size 2&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">var</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s1">&#39; should contain positive numbers&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reverse_dims</span><span class="p">:</span>
        <span class="n">map_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">num_comps</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">num_comps</span><span class="p">)</span>
    <span class="n">num_comps</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">evenly_spaced</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subtitle</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subtitle</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_comps</span><span class="p">:</span>
            <span class="c1"># remove additional subtitles</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">subtitle</span><span class="p">[:</span><span class="n">num_comps</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">subtitle</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_comps</span><span class="p">:</span>
            <span class="c1"># add subtitles</span>
            <span class="n">subtitle</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Component&#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subtitle</span><span class="p">),</span> <span class="n">num_comps</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subtitle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="s1">&#39;Component&#39;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="p">[</span><span class="n">subtitle</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_pos</span><span class="p">]</span>

    <span class="n">fig_h</span><span class="p">,</span> <span class="n">fig_w</span> <span class="o">=</span> <span class="n">fig_mult</span>

    <span class="n">p_rows</span><span class="p">,</span> <span class="n">p_cols</span> <span class="o">=</span> <span class="n">get_plot_grid_size</span><span class="p">(</span><span class="n">num_comps</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_rows</span> <span class="o">*</span> <span class="n">p_cols</span> <span class="o">&lt;</span> <span class="n">num_comps</span><span class="p">:</span>
        <span class="n">p_cols</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">pad_w</span><span class="p">,</span> <span class="n">pad_h</span> <span class="o">=</span> <span class="n">pad_mult</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set defaults for kwargs to the figure creation and extract any non-default values from current kwargs</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">figkwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">inspec_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inspec_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inspec_func</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">figkwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)})</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">p_cols</span> <span class="o">*</span> <span class="n">fig_w</span><span class="p">,</span> <span class="n">p_rows</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">),</span> <span class="o">**</span><span class="n">figkwargs</span><span class="p">)</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set defaults for kwargs to the ImageGrid and extract any non-default values from current kwargs</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">igkwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="s1">&#39;1%&#39;</span><span class="p">,</span>
                <span class="s1">&#39;cbar_size&#39;</span><span class="p">:</span> <span class="s1">&#39;5%&#39;</span><span class="p">,</span>
                <span class="s1">&#39;cbar_location&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
                <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;row&#39;</span><span class="p">,</span>
                <span class="s1">&#39;add_all&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;share_all&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;label_mode&#39;</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">igkwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">igkwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)})</span>

    <span class="n">axes</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">p_rows</span><span class="p">,</span> <span class="n">p_cols</span><span class="p">),</span>
                     <span class="n">cbar_mode</span><span class="o">=</span><span class="n">color_bar_mode</span><span class="p">,</span>
                     <span class="n">axes_pad</span><span class="o">=</span><span class="p">(</span><span class="n">pad_w</span> <span class="o">*</span> <span class="n">fig_w</span><span class="p">,</span> <span class="n">pad_h</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">),</span>
                     <span class="o">**</span><span class="n">igkwargs</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="c1"># These parameters have not been easy to fix:</span>
    <span class="k">if</span> <span class="n">title_yoffset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title_yoffset</span> <span class="o">=</span> <span class="mf">0.9</span>
    <span class="k">if</span> <span class="n">title_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title_size</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">+</span> <span class="p">(</span><span class="n">p_rows</span> <span class="o">+</span> <span class="n">p_cols</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_size</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">title_yoffset</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">curr_subtitle</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">chosen_pos</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">chosen_pos</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">):</span>
        <span class="n">im</span><span class="p">,</span> <span class="n">im_cbar</span> <span class="o">=</span> <span class="n">plot_map</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">count</span><span class="p">],</span>
                               <span class="n">map_stack</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                               <span class="n">stdevs</span><span class="o">=</span><span class="n">stdevs</span><span class="p">,</span> <span class="n">show_cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">curr_subtitle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color_bar_mode</span> <span class="ow">is</span> <span class="s1">&#39;each&#39;</span><span class="p">:</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">colorbar_label</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">%</span> <span class="n">p_cols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">p_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_cols</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color_bar_mode</span> <span class="ow">is</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">colorbar_label</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="export_fig_data"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pyUSID.viz.plot_utils.html#pyUSID.viz.plot_utils.export_fig_data">[docs]</a><span class="k">def</span> <span class="nf">export_fig_data</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">include_images</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the data of all plots in the figure `fig` to a plain text file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">        The figure containing the data to be exported</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename of the output text file</span>
<span class="sd">    include_images : bool</span>
<span class="sd">        Should images in the figure also be exported</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the data from the figure</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
    <span class="n">axes_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="n">ims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ims</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">include_images</span><span class="p">:</span>
            <span class="n">im_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">ims</span><span class="p">:</span>
                <span class="c1"># Image data</span>
                <span class="n">im_lab</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                <span class="n">im_dict</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>

                <span class="c1"># X-Axis</span>
                <span class="n">x_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span>
                <span class="n">x_lab</span> <span class="o">=</span> <span class="n">x_ax</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">x_lab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">x_lab</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>

                <span class="n">im_dict</span><span class="p">[</span><span class="n">x_lab</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_ax</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>

                <span class="c1"># Y-Axis</span>
                <span class="n">y_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span>
                <span class="n">y_lab</span> <span class="o">=</span> <span class="n">y_ax</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">y_lab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">y_lab</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>

                <span class="n">im_dict</span><span class="p">[</span><span class="n">y_lab</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_ax</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>

                <span class="n">ax_dict</span><span class="p">[</span><span class="s1">&#39;Images&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">im_lab</span><span class="p">:</span> <span class="n">im_dict</span><span class="p">}</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">line_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="n">xlab</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">()</span>
            <span class="n">ylab</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">xlab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">xlab</span> <span class="o">=</span> <span class="s1">&#39;X Data&#39;</span>
            <span class="k">if</span> <span class="n">ylab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">ylab</span> <span class="o">=</span> <span class="s1">&#39;Y Data&#39;</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">line_dict</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()]</span> <span class="o">=</span> <span class="p">{</span><span class="n">xlab</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(),</span>
                                               <span class="n">ylab</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()}</span>

            <span class="n">ax_dict</span><span class="p">[</span><span class="s1">&#39;Lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_dict</span>

        <span class="k">if</span> <span class="n">ax_dict</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">():</span>
            <span class="n">axes_dict</span><span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_title</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ax_dict</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Now that we have the data from the figure, we need to write it to file.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">folder</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>

    <span class="n">spacer</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;**********************************************\n&#39;</span>

    <span class="n">data_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax_lab</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Axis: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ax_lab</span><span class="p">))</span>

        <span class="k">if</span> <span class="s1">&#39;Images&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">im_lab</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;Images&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Image: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">im_lab</span><span class="p">))</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">im_data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">im_data</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">im</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">val</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;Lines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">line_lab</span><span class="p">,</span> <span class="n">line_dict</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;Lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Line: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line_lab</span><span class="p">))</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span> <span class="o">=</span> <span class="n">line_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">line_dict</span><span class="p">[</span><span class="n">dim1</span><span class="p">],</span> <span class="n">line_dict</span><span class="p">[</span><span class="n">dim2</span><span class="p">]):</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">val2</span><span class="p">)))</span>

            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>

        <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>

    <span class="n">data_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Suhas Somnath, Chris R. Smith, Stephen Jesse.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.0.4',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>